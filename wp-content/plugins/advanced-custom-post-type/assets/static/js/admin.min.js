var $=jQuery.noConflict();jQuery(function(g){function v(e,t){return jQuery(e.replace(/(\[|\])/g,"\\$1"),t)}let u=wp.i18n.__;function h(){return"object"==typeof window.wpEditorL10n}var e;d="string"==typeof ajaxurl?ajaxurl:"/wp-admin/admin-ajax.php",(e=new FormData).append("action","languagesAction"),fetch(d,{method:"POST",body:e}).then(e=>e.json()).then(e=>{document.adminjs={translations:e},document.dispatchEvent(new Event("fetchLanguages"))}).catch(e=>{console.error("Something went wrong!",e)});let o=e=>{var t,e=e.match(/viewBox=\"(.*?)\"/);return e?(t=(e=e[1].split(" "))[2],t=Number(t/e[3]),parseFloat(t).toFixed(2)):1},n=e=>{e=e.replace("#","");e=2*parseInt(e.substring(0,2),16)+3*parseInt(e.substring(2,4),16)+parseInt(e.substring(4,6),16);return isNaN(e)?null:e},r=e=>{let a=[],i=[];e.map(e=>{var t=n(e);null!==t&&(a.push(t),i.push(e))});e=Math.min(...a),e=a.indexOf(e);return-1===e?null:i[e]},s=(g(".acpt-toggle-indicator").on("click",function(){var e=g(this).data("target");g("#"+e).toggleClass("closed")}),g(".acpt-range").on("change",function(){var e=g(this).attr("id"),t=g(this).val();g(`#${e}_value`).text(t)}),g("#commentform").length&&(g("#commentform")[0].encoding="multipart/form-data"),g("#addtag").on("mousedown","#submit",function(){(()=>{let e=["attachment_id","city","country","currency","dial","forged_by","label","lat","length","lng","weight"];["image-preview","file-preview","preview-file","acpt_map_preview","acpt_map_multi_preview","embed-preview"].forEach(function(e){g("#addtag ."+e).html("")}),g("#addtag").find("input").each(function(){let t=g(this),a=t.attr("name");a&&e.forEach(function(e){1==a.endsWith("_"+e)&&t.val("")})})})(),"undefined"!=typeof tinyMCE&&(tinyMCE.triggerSave(),g(document).bind("ajaxSuccess.vtde_add_term",function(){tinyMCE.activeEditor&&tinyMCE.activeEditor.setContent(""),g(document).unbind("ajaxSuccess.vtde_add_term",!1)}))}),g("body").on("click",".acpt-relation-field-selector .options .value",function(e){var t,a,i,n,l,d,r,o;e.preventDefault(),g(this).hasClass("disabled")||(t=(e=g(this)).attr("id"),a=(o=e.parent()).attr("id").replace("options_",""),o=o.data("max"),i="selected_items_"+a,n="title_"+a,l="values_"+a,d=e.data("value"),r=e.html(),o&&g("#"+i).children().length>=o)||((o=g("#"+l).val()?g("#"+l).val().split(","):[]).push(d),g("#"+l).val(o.join(",")),g("#"+i).append(`
            <div id="${t}" class="value" data-value="${d}">
                <span class="placeholder">${r}</span> 
                <a class="delete" href="#">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24">
                        <path d="M5 20a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V8h2V6h-4V4a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2v2H3v2h2zM9 4h6v2H9zM8 8h9v12H7V8z"></path><path d="M9 10h2v8H9zm4 0h2v8h-2z"></path>
                    </svg>
                </a>
            </div>
        `),document.getElementById(l).dispatchEvent(new Event("change")),e.addClass("hidden"),e.addClass("selected"),s(g("#"+n),a))}),g("body").on("click",".acpt-relation-field-selector .selected-items .delete",function(e){e.preventDefault();e=g(this);let t=e.parent().data("value");var a=e.parent().parent().attr("id").replace("selected_items_",""),i="values_"+a,n="title_"+a;let l=g("#"+i).val().split(",");l=l.filter(e=>(e=>{let t=""+e;return null!==(t=t.match("^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"))})(e)?e!==t:parseInt(e)!==t),g("#"+i).val(l.join(",")),document.getElementById(i).dispatchEvent(new Event("change")),g("#"+e.parent().attr("id")).removeClass("hidden"),g("#"+e.parent().attr("id")).removeClass("selected"),e.parent().remove(),s(g("#"+n),a)}),g("body").on("click",".acpt-relation-field-selector .delete-all",function(e){e.preventDefault(),e.stopPropagation();var e=g(this),t=e.attr("id");g("#selected_items_"+t).find(".value").each(function(){g(this).remove()}),g("#options_"+t).find(".value").each(function(){g(this).removeClass("hidden"),g(this).removeClass("selected")}),g("#values_"+t).val(""),document.getElementById("values_"+t).dispatchEvent(new Event("change")),e.remove()}),g("body").on("keyup",".acpt-relation-field-selector .acpt-form-control",function(){var e=g(this);let t=e.val();e=e.attr("id").replace("search_","");g("#options_"+e).find(".value").each(function(){var e=`.*${t}.*`,e=new RegExp(e,"gi");g(this).hasClass("selected")||(e.test(g(this).text())?g(this).removeClass("hidden"):g(this).addClass("hidden"))})}),(e,t)=>{0===g("#selected_items_"+t).children().length?g("#"+t).remove():0===e.find(".delete-all").length&&e.append(`<a href="#" id="${t}" class="delete-all">${useTranslation("Delete all")}</a>`)}),m=()=>{try{"undefined"!=typeof sortable&&(g(".playlist-preview").length&&(sortable(".playlist-preview",{acceptFrom:".playlist-preview",forcePlaceholderSize:!0,items:".audio",hoverClass:"hover",copy:!1}),g(".playlist-preview").each(function(e){let c=e;sortable(".playlist-preview")[e]&&sortable(".playlist-preview")[e].addEventListener("sortupdate",function(e){e=e.detail.destination.items;let t=[];e.map(e=>{t.push(g(e).data("index"))});var e=g(this).data("target"),a=g("#"+e+"_copy");let i;i=0<g("#"+e+"_attachment_id").length?g("#"+e+"_attachment_id"):g("#"+e+"\\[attachment_id\\]\\["+c+"\\]");e=a.next(".inputs-wrapper");let n=i.val().split(","),l=a.val().split(","),d=e.children("input"),r=[],o=[],s=[];t.map(e=>{r.push(n[e]),o.push(l[e]),d.each(function(){g(this).data("index")===e&&s.push(g(this))})}),i.val(r.join(",")),a.val(o.join(",")),0<a.length&&a[0].dispatchEvent(new Event("change")),e.html(s)})}),sortable(".playlist-preview","reload")),g(".gallery-preview").length&&(sortable(".gallery-preview",{acceptFrom:".gallery-preview",forcePlaceholderSize:!0,items:".image",hoverClass:"hover",copy:!1}),g(".gallery-preview").each(function(e){let c=e;sortable(".gallery-preview")[e]&&sortable(".gallery-preview")[e].addEventListener("sortupdate",function(e){e=e.detail.destination.items;let t=[];e.map(e=>{t.push(g(e).data("index"))});var e=g(this).data("target"),a=g("#"+e+"_copy");let i;i=0<g("#"+e+"_attachment_id").length?g("#"+e+"_attachment_id"):g("#"+e+"\\[attachment_id\\]\\["+c+"\\]");e=a.next(".inputs-wrapper");let n=i.val().split(","),l=a.val().split(","),d=e.children("input"),r=[],o=[],s=[];t.map(e=>{r.push(n[e]),o.push(l[e]),d.each(function(){g(this).data("index")===e&&s.push(g(this))})}),i.val(r.join(",")),a.val(o.join(",")),0<a.length&&a[0].dispatchEvent(new Event("change")),e.html(s)})}),sortable(".gallery-preview","reload")),0<g(".acpt-sortable").length&&g(".acpt-sortable").each(function(e){var t=g(this).attr("id"),a=t.replace("acpt-sortable-","");sortable("#"+t,{acceptFrom:"#"+t,forcePlaceholderSize:!0,items:".sortable-li-"+a,handle:".handle",hoverClass:"hover",copy:!1})[0].addEventListener("sortupdate",function(e){var t=new Event("acpt_grouped_element_sorted");document.dispatchEvent(t)}),sortable("#"+t,"reload"),sortable("#"+t)[e]&&sortable("#"+t)[e].addEventListener("sortupdate",function(e){e.detail.item.id&&(e=g("#"+e.detail.item.id).find("textarea.acpt-wp-editor"))&&(i(e.attr("id")),S(e.attr("id"),e.attr("rows")))})}),0<g(".acpt-nested-sortable").length)&&g(".acpt-nested-sortable").each(function(e){var t=g(this).attr("id"),a=t.replace("block-elements-","");sortable("#"+t,{acceptFrom:"#"+t,forcePlaceholderSize:!0,items:".sortable-li-"+a,handle:".handle",hoverClass:"hover",copy:!1})[0].addEventListener("sortupdate",function(e){var t=new Event("acpt_grouped_element_sorted");document.dispatchEvent(t)}),sortable("#"+t,"reload"),sortable("#"+t)[e]&&sortable("#"+t)[e].addEventListener("sortupdate",function(e){e.detail.item.id&&(e=g("#"+e.detail.item.id).find("textarea.acpt-wp-editor"))&&(i(e.attr("id")),S(e.attr("id",e.attr("rows"))))})})}catch(e){console.error(e)}},f=(g(document).on("click",function(e){0===g(e.target).closest(".sortable-li-active").length&&(e=g(".sortable-li-active"))&&e.each(function(){g(this).removeClass("sortable-li-active")})}),g("body").on("mousedown",".sortable-li",function(){var e=g(this);e.attr("class").includes("sortable-li-active")||0<e.find(".sortable-li-active").length||(g(".sortable-li-active").each(function(){g(this).removeClass("sortable-li-active")}),e.addClass("sortable-li-active"))}),g("body").on("change",".acpt-leading-field",function(n){var e=g(this);let l=e.attr("type"),d="object"==typeof e.val()?e.val().join(", "):e.val();e.parents().each(function(){var e,t,a=g(this),i=a.attr("class");i&&i.includes("sortable-li")&&("checkbox"===l?(i=n.target.checked,t=(e=a.find(".sortable-li_collapsed_placeholder").find("span.value")).text().split(", ").filter(e=>""!==e),i?(t.push(d),e.text(t.join(", "))):e.text(t.filter(e=>e!==d).join(", "))):a.find(".sortable-li_collapsed_placeholder").find("span.value").text(d))})}),g("body").on("click",".remove-all-grouped-elements",function(e){e.preventDefault();var e=g(this),t=e.data("layout"),a=e.data("element"),i=(e.data("elements"),e.data("groupId")),i=g(`.add-grouped-element[data-group-id=${i}]`);let n;var l=(n="table"===t?e.prev("a").prev(".acpt-table-responsive").find(".acpt-table").find(".acpt-sortable"):e.prev("a").prev(".acpt-sortable")).data("max-blocks"),d=n.attr("id"),e=e.data("group-id"),r=n.find("tr").children.length;n&&(e=`<p data-message-id="${e}" class="update-nag notice notice-warning inline no-records">${useTranslation(`No fields saved, generate the first one clicking on "Add ${a}" button`)}</p>`,"table"===t?(n.children("tr").each(function(e,t){0<e&&t.remove()}),a=r+2,g("#"+d).append(`<tr><td colspan="${a}">${e}</td></tr>`)):(n.empty(),g("#"+d).html("").append(e)),l)&&0<l&&i.removeAttr("disabled")}),g("body").on("click",".add-grouped-element",function(e){e.preventDefault();let t=g(this);e=t.data("group-id");let a=t.data("layout");var i=t.data("media-type"),n=t.data("parent-index"),l=t.data("parent-name");let d=g('[data-message-id="'+e+'"]'),r,o=0;o=("table"===a?(r=t.prev(".acpt-table-responsive").find(".acpt-table").find(".acpt-sortable").first()).find("tr.sortable-li"):(r=t.prev("ul.acpt-sortable")).find("li")).length;r.data("min-blocks");let s=r.data("max-blocks"),c=()=>void 0===s||r.find(".sortable-li").length<s;c()&&g.ajax({type:"POST",url:ajaxurl,data:{action:"generateGroupedFieldsAction",data:JSON.stringify({id:e,mediaType:i,index:o,parentName:l,parentIndex:n})},success:function(e){r&&(r.append(e.fields),m(),D(),c()?t.removeAttr("disabled"):t.attr("disabled","disabled"),e=new Event("acpt_grouped_element_added"),document.dispatchEvent(e),d&&("table"===a?d.parent("td").parent("tr"):d).remove(),(e=r.find(".acpt-daterangepicker"))&&0<e.length&&w(e[e.length-1].id),(e=r.find("textarea.acpt-codemirror"))&&0<e.length&&f(e[e.length-1].id),(e=r.find(".acpt-color-picker"))&&0<e.length&&y(e[e.length-1].id),(e=r.find("select.acpt-select2"))&&0<e.length&&b(e[e.length-1].id),(e=r.find("textarea.acpt-wp-editor"))&&0<e.length&&S(e[e.length-1].id,e[e.length-1].getAttribute("rows")),(e=r.find("input.acpt-phone"))&&0<e.length&&k(e[e.length-1].id),(e=r.find("input.acpt-country"))&&0<e.length&&x(e[e.length-1].id),(e=r.find(".acpt-qr-code-wrapper"))&&0<e.length&&E(e[e.length-1].id),(e=r.find(".acpt-embed"))&&0<e.length&&$(e[e.length-1].id),e=r.find(".acpt-textarea"))&&0<e.length&&C(e[e.length-1].id)},dataType:"json"})}),g("body").on("click",".sortable-li_toggle_visibility",function(e){e.preventDefault();var e=g(this),t=e.data("target-id"),t=g("#"+t),e=(e.hasClass("reverse")?e.removeClass("reverse"):e.addClass("reverse"),t.hasClass("hidden")?t.removeClass("hidden"):t.addClass("hidden"),new Event("acpt_grouped_element_toggle_visibilty"));document.dispatchEvent(e)}),g("body").on("click","a.remove-grouped-element",function(e){e.preventDefault();var e=g(this),t=e.data("parent-id"),a=e.data("target-id"),i=e.data("layout"),n=e.data("element"),e=(e.data("elements"),g("#"+a)),a=e.children.length;let l=e.parent();var d=l.attr("id");l.data("min-blocks");let r=l.data("max-blocks"),o=g(`.add-grouped-element[data-group-id=${t}]`),s=()=>void 0===r||l.find(".sortable-li ").length<r;e.remove(),s()?o.removeAttr("disabled"):o.attr("disabled","disabled");let c;0===(c="table"===i?l.find("tr").length-1:l.find("li").length)&&(e=`<p data-message-id="${t}" class="update-nag notice notice-warning inline no-records">${useTranslation(`No fields saved, generate the first one clicking on "Add ${n}" button`)}</p>`,"table"===i?(t=a+2,g("#"+d).append(`<tr><td colspan="${t}">${e}</td></tr>`)):g("#"+d).html("").append(e));n=new Event("acpt_grouped_element_removed");document.dispatchEvent(n)}),g("body").on("click",".acpt_add_flexible_btn",function(e){e.preventDefault();var e=g(this),t=e.next(".acpt_flexible_block_items");e.hasClass("active")?e.removeClass("active"):e.addClass("active"),t.hasClass("active")?t.removeClass("active"):t.addClass("active")}),document.addEventListener("click",function(e){e=e.target;!1===(e.classList.contains("acpt_flexible_block_item")||e.classList.contains("acpt_add_flexible_btn")||e.classList.contains("acpt_add_flexible_btn_label")||e.classList.contains("acpt_add_flexible_btn_icon")||e.classList.contains("acpt_add_flexible_btn_icon")||e.parentNode.classList.contains("acpt_add_flexible_btn_icon"))&&(g(".acpt_flexible_block_items").removeClass("active"),g(".acpt_add_flexible_btn").removeClass("active"))}),g("body").on("click",".remove-all-blocks",function(e){e.preventDefault();var t,e=g(this),a=e.data("block-list-id"),i=g("ul#acpt-sortable-"+a),n=(e.data("min-blocks"),e.data("max-blocks")),e=e.prev().prev();i&&(i.empty(),t=useTranslation('No blocks saved, generate the first one clicking on "Add block" button'),i.append(`<p data-message-id="${a}" class="update-nag notice notice-warning inline no-records">${t}</p>`),n)&&0<n&&e.attr("disabled",!1)}),g("body").on("click",".acpt_flexible_block_items > li",function(e){e.preventDefault();var e=g(this),t=e.parent(),a=e.data("layout"),i=e.data("value"),n=e.data("block-list-id"),l=e.data("parent-name"),d=(e.data("block-index"),e.data("media-type")),r=e.data("field-id"),o=e.data("min-blocks");let s=e.data("max-blocks"),c=g("ul#acpt-sortable-"+n),p=c.find("li.acpt_blocks_list_item").length,v=c.next(".acpt_add_flexible_block").find("button"),u=g('[data-message-id="'+r+'"]');(void 0===s||""===s||p<s)&&g.ajax({type:"POST",url:ajaxurl,data:{action:"generateFlexibleBlockAction",data:JSON.stringify({layout:a,blockId:i,mediaType:d,parentName:l,index:p,blockListId:n,minBlocks:o,maxBlocks:s})},success:function(e){c&&(c.append(e.block),void 0===s||""===s||p+1>=s||v.attr("disabled",!0),m(),D(),u&&u.remove(),(e=c.find(".acpt-daterangepicker"))&&0<e.length&&w(e[e.length-1].id),(e=c.find("textarea.acpt-codemirror"))&&0<e.length&&f(e[e.length-1].id),(e=c.find(".acpt-color-picker"))&&0<e.length&&y(e[e.length-1].id),(e=c.find("select.acpt-select2"))&&0<e.length&&b(e[e.length-1].id),(e=c.find("textarea.acpt-wp-editor"))&&0<e.length&&S(e[e.length-1].id,e[e.length-1].getAttribute("rows")),(e=c.find("input.acpt-phone"))&&0<e.length&&k(e[e.length-1].id),(e=c.find("input.acpt-country"))&&0<e.length&&x(e[e.length-1].id),(e=c.find(".acpt-qr-code-wrapper"))&&0<e.length&&E(e[e.length-1].id),(e=c.find(".acpt-embed"))&&0<e.length&&$(e[e.length-1].id),e=c.find(".acpt-textarea"))&&0<e.length&&C(e[e.length-1].id)},dataType:"json"}),t.removeClass("active")}),g("body").on("click",".acpt_delete_all_flexible_element_btn",function(e){e.preventDefault();var e=g(this),t=e.data("block-id"),a=e.data("group-id"),i=e.data("element"),n=e.data("layout"),e=e.data("index"),t=(g('[data-parent-id="'+t+'"]'),g(`#block-elements-${a}-`+e)),a=`block-elements-${a}-`+e;t&&(e=`<p data-message-id="${a}" class="update-nag notice notice-warning inline no-records">${useTranslation(`No fields saved, generate the first one clicking on "Add ${i}" button`)}</p>`,"table"===n?(i=t.find("tr").children.length,t.children("tr").each(function(e,t){0<e&&t.remove()}),n=i+2,g("#"+a).append(`<tr><td colspan="${n}">${e}</td></tr>`)):(t.empty(),g("#"+a).html("").append(e)))}),g("body").on("click",".acpt_add_flexible_element_btn",function(e){e.preventDefault();var e=g(this),t=e.data("block-id");let a=e.data("layout");var i=e.data("group-id"),n=e.data("media-type"),l=e.data("parent-name"),d=e.data("index"),r=e.data("min-blocks"),e=e.data("max-blocks"),t=g('[data-parent-id="'+t+'"]');let o=t.find(`#block-elements-${i}-`+d),s=t.find('[data-message-id="block-elements-'+i+"-"+d+'"]');g.ajax({type:"POST",url:ajaxurl,data:{action:"generateFlexibleGroupedFieldsAction",data:JSON.stringify({blockId:i,mediaType:n,elementIndex:(t=a,i=o,"table"===t?1==(t=i.find("tr").length-1)&&1===i.find("tr").find("td").length?0:t:i.find("li").length),blockIndex:d,layout:a,parentName:l,minBlocks:r,maxBlocks:e})},success:function(e){o&&(o.append(e.fields),m(),D(),e=new Event("acpt_flexible_element_added"),document.dispatchEvent(e),s&&("table"===a?s.parent("td").parent("tr"):s).remove(),(e=o.find(".acpt-daterangepicker"))&&0<e.length&&w(e[e.length-1].id),(e=o.find("textarea.acpt-codemirror"))&&0<e.length&&f(e[e.length-1].id),(e=o.find(".acpt-color-picker"))&&0<e.length&&y(e[e.length-1].id),(e=o.find("select.acpt-select2"))&&0<e.length&&b(e[e.length-1].id),(e=o.find("textarea.acpt-wp-editor"))&&0<e.length&&S(e[e.length-1].id,e[e.length-1].getAttribute("rows")),(e=o.find("input.acpt-phone"))&&0<e.length&&k(e[e.length-1].id),(e=o.find("input.acpt-country"))&&0<e.length&&x(e[e.length-1].id),(e=o.find(".acpt-qr-code-wrapper"))&&0<e.length&&E(e[e.length-1].id),(e=o.find(".acpt-embed"))&&0<e.length&&$(e[e.length-1].id),e=o.find(".acpt-textarea"))&&0<e.length&&C(e[e.length-1].id)},dataType:"json"})}),g("body").on("click",".acpt_blocks_list_item_toggle_visibility",function(e){e.preventDefault();var e=g(this),t=e.data("target-id"),a=g("#"+t),t=(g("*[data-parent-id="+t+"]"),g("*[data-block-id="+t+"]"),e.parent().parent(),e.hasClass("reverse")?e.removeClass("reverse"):e.addClass("reverse"),a.hasClass("collapsed")?a.removeClass("collapsed"):a.addClass("collapsed"),new Event("acpt_grouped_element_toggle_visibilty"));document.dispatchEvent(t)}),g("body").on("click",".acpt_blocks_list_item_delete",function(e){e.preventDefault();var e=g(this).data("target-id"),e=g("#"+e),t=e.parent(),a=t.attr("id");let i=t.find("li.acpt_blocks_list_item").length;t.data("min-blocks");let n=t.data("max-blocks");var l=t.next(".acpt_add_flexible_block").find("button");(void 0===n||""===n||i>=n)&&l.attr("disabled",!1),e.remove(),1===i&&(l=useTranslation('No blocks saved, generate the first one clicking on "Add block" button'),t.append(`<p data-message-id="${a}" class="update-nag notice notice-warning inline no-records">${l}</p>`))}),g("body").on("click",".list-add-element",function(e){e.preventDefault();var e=g(this),t=e.data("target-id"),a=e.prev("table").children(".list-wrapper"),i=a.find("tr").length,e=e.data("parent-name");a.append(`
            <tr id="${e}_${i}" class="list-element sortable-li sortable-li-${t}">
                <td width="20">
                    <div class="handle">
                        .<br/>.<br/>.
                    </div>
                </td>
                <td>
                    <input id="${e}_${i}" name="${e}[]" type="text" class="acpt-form-control list-element">
                </td>
                <td width="100">
                    <a class="list-remove-element" data-parent-name="${e}" data-target-id="${e}_${i}" href="#">${useTranslation("Remove element")}</a>
                </td>
            </tr>
        `),m()}),g("body").on("click","a.list-remove-element",function(e){e.preventDefault();e=g(this).data("target-id"),e=document.getElementById(e);e&&e.remove()}),g("body").on("change",".post-relationship",function(e){e.preventDefault();let t=g(this).val();Array.isArray(t)&&(t=t.join(",")),g("#inversedBy").val(t)}),g("body").on("click",".edit-file-label",function(e){var t=g(this),e=(e.preventDefault(),t.parent("div"));t.prev("input").removeClass("hidden"),t.addClass("hidden"),t.next(".save-file-label").removeClass("hidden"),e.find("a.acpt-text-truncate").addClass("hidden")}),g("body").on("click",".save-file-label",function(e){var t=g(this),e=(e.preventDefault(),t.parent("div")),a=e.find("input").val();t.prev("a").prev("input").addClass("hidden"),t.addClass("hidden"),t.prev(".edit-file-label").removeClass("hidden"),e.find("a.acpt-text-truncate").text(a),e.find("a.acpt-text-truncate").removeClass("hidden")}),g("body").on("click",".file-delete-btn",function(e){var t=g(this),e=(e.preventDefault(),t.data("target-id"),t.parent("div")),t=e.find("input"),e=e.prev(".file-preview");t.val(""),0<t.length&&t[1]&&t[1].dispatchEvent(new Event("change")),e.html("<span>No file selected</span>")}),g("body").on("click",".upload-file-btn",function(e){var t=g(this),a=t.data("id"),i=t.data("accepts");let d=t.data("max-size"),r=t.data("min-size"),o=t.data("target-id"),s=t.data("hide-label"),c=t.data("label-name"),p=t.prev("input"),v=p.prev("input"),u=g("#file-errors-"+a),h=t.parent("div");if(e.preventDefault(),wp&&wp.media){let l=wp.media({title:useTranslation("Upload a File"),library:{type:i.replace("document","application").split(",")},multiple:!1});l.on("open",function(e){var t,a;""!==v.val()&&(t=l.state().get("selection"),a=wp.media.attachment(v.val()),t.add(a))}),l.on("select",function(e){var t=l.state().get("selection").first(),a=t.attributes.filesizeInBytes;if(d&&1048576*d<a)return void u.html("Max size: "+d+"Mb");if(r&&a<1048576*r)return void u.html("Min size: "+r+"Mb");var a=t.toJSON().url,i=t.toJSON().id,t=t.toJSON().filename;v.val(i),p.val(a),0<p.length&&p[0].dispatchEvent(new Event("change"));let n=`<a title="${a}" class="acpt-text-truncate" target="_blank" href="${a}">${t}</a>`;0===s&&(n=(n=(n+=`<input id="${o}" name="${c}" type="text" class="hidden file-label-input" value="${t}" placeholder="${useTranslation("Enter download text link")}">`)+`<a href="#" data-target-id="${o}" class="edit-file-label" title="${useTranslation("Edit label")}">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" viewBox="0 0 24 24"><path fill="currentColor" d="M4 21a1 1 0 0 0 .24 0l4-1a1 1 0 0 0 .47-.26L21 7.41a2 2 0 0 0 0-2.82L19.42 3a2 2 0 0 0-2.83 0L4.3 15.29a1.06 1.06 0 0 0-.27.47l-1 4A1 1 0 0 0 3.76 21A1 1 0 0 0 4 21M18 4.41L19.59 6L18 7.59L16.42 6zM5.91 16.51L15 7.41L16.59 9l-9.1 9.1l-2.11.52z"/></svg>
                </a>`)+`<a href="#" data-target-id="${o}" class="save-file-label hidden" title="${useTranslation("Save label")}">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" viewBox="0 0 24 24"><path fill="currentColor" d="m10 15.586l-3.293-3.293l-1.414 1.414L10 18.414l9.707-9.707l-1.414-1.414z"/></svg>
                </a>`),h.prev(".file-preview").html(n)}),l.open();a=new Event("acpt_media_added");document.dispatchEvent(a)}else alert(useTranslation("The media gallery is not available. You must admin_enqueue this function: wp_enqueue_media()"))}),g("body").on("click",".upload-delete-btn",function(e){e.preventDefault(),e.stopPropagation();var e=g(this),t=e.data("target-id");let a=e.hasClass("delete-video-btn"),i=e.hasClass("delete-audio-btn");var n=()=>i?"No audio selected":a?"No video selected":"No image selected",t=(g("#"+t).val(""),g("#"+t+"_copy").val(""),0<g("#"+t).length&&g("#"+t)[0].dispatchEvent(new Event("change")),0<g("#"+t+"_copy").length&&g("#"+t+"_copy")[0].dispatchEvent(new Event("change")),g("#"+t+"_attachment_id").val(""),g("#"+t+"[attachment_id]").val(""),e.prev(".button").prev(".inputs-wrapper").html(""),e.parent("div").prev(".image-preview").html(`<span class="placeholder">${useTranslation(n())}</span>`),e.parent("div").prev(".audio-preview").html(`<span class="placeholder">${useTranslation(n())}</span>`),e.parent("div").prev(".playlist-preview").html(`<span class="placeholder">${useTranslation(n())}</span>`),new Event("acpt_media_added"));document.dispatchEvent(t)}),g("body").on("click",".upload-audio-btn",function(e){var t=g(this);let r=t.prev("input"),o=r.prev("input"),s=t.parent("div");if(e.preventDefault(),e.stopPropagation(),wp&&wp.media){let d=wp.media({title:useTranslation("Upload an Audio file"),library:{type:["audio"]},multiple:!1});d.on("open",function(e){var t,a;""!==o.val()&&(t=d.state().get("selection"),a=wp.media.attachment(o.val()),t.add(a))}),d.on("select",function(e){var t=d.state().get("selection").first(),a=t.toJSON().url,i=t.toJSON().id,n=t.toJSON().title?t.toJSON().title:"Unknown title",l=t.toJSON().meta.album?t.toJSON().meta.album:"Unknown album",t=t.toJSON().meta.artist?t.toJSON().meta.artist:"Unknown artist";o.val(i),r.val(a),0<r.length&&r[0].dispatchEvent(new Event("change")),s.prev(".audio-preview").html(`
                <div class="audio">
                     <div class="acpt-audio-meta-wrapper">
                        <div class="acpt-audio-meta">
                            <h5 class="title">${n}</h5>
                            <div class="meta">
                                <span class="artist">${t}</span>
                                <span class="album">- ${l}</span>
                            </div>
                        </div>
                     </div>
                    <audio class="acpt-audio-player" controls src="${a}"></audio>
                </div>`)}),d.open();t=new Event("acpt_media_added");document.dispatchEvent(t)}else alert(useTranslation("The media gallery is not available. You must admin_enqueue this function: wp_enqueue_media()"))}),g("body").on("click",".upload-playlist-btn",function(e){let s=g(this),c=s.prev(".inputs-wrapper"),p=c.prev("input").prev("input"),v=s.data("parent-index"),u=c.data("target"),h=c.data("target-copy"),m=g("#"+u+"_copy");if(e.preventDefault(),e.stopPropagation(),wp&&wp.media){let n=wp.media({title:useTranslation("Select audio files"),library:{type:["audio"]},button:{text:useTranslation("Add audio files to the playlist")},multiple:"add"});n.on("open",function(e){if(""!==p.val()){let t=[];var a=n.state().get("selection");p.val().split(",").forEach(e=>{t.push(wp.media.attachment(e))}),a.add(t)}}),n.on("select",function(e){let t=[],a=[],l=[],d=[],r=[],i=(n.state().get("selection").map(function(e){e.toJSON(),e.attributes.url&&(t.push(e.attributes.id),a.push(e.attributes.url),l.push(e.attributes.title),d.push(e.attributes.meta.artist||"Unknown artist"),r.push(e.attributes.meta.album||"Unknown album"))}),[]),o=(c.html(""),a.map((e,t)=>{var a=h||u;c.append('<input name="'+a+'[]" type="hidden" data-index="'+t+'" value="'+e+'">'),i.push(e)}),"");0<i.length&&s.next("button").removeClass("hidden"),i.map((e,t)=>{var a=l[t],i=d[t],n=r[t];o+=`<div class="audio" data-index="${t}" draggable="true">
                    <div class="handle">
                        .<br/>.<br/>.
                    </div>
                    <div class="acpt-audio-meta-wrapper">
                        <div class="acpt-audio-meta">
                            <h5 class="title">${a}</h5>
                            <div class="meta">
                                <span class="artist">${i}</span>
                                <span class="album">- ${n}</span>
                            </div>
                        </div>
                        <audio class="acpt-audio-player" controls src="${e}"></audio>
                    </div>
                    <a class="delete-playlist-audio-btn" data-index="${t}" data-parent-index="${v}" href="#" title="${useTranslation("Delete")}">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24">
                            <path d="M5 20a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V8h2V6h-4V4a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2v2H3v2h2zM9 4h6v2H9zM8 8h9v12H7V8z"></path><path d="M9 10h2v8H9zm4 0h2v8h-2z"></path>
                        </svg>
                    </a>
                </div>`}),s.parent("div").prev(".playlist-preview").html(o),m.val(i.join(",")),m[0].dispatchEvent(new Event("change")),p.val(t.join(","))}),n.open();e=new Event("acpt_media_added");document.dispatchEvent(e)}else alert(useTranslation("The media gallery is not available. You must admin_enqueue this function: wp_enqueue_media()"))}),g("body").on("click",".delete-playlist-audio-btn",function(e){var t=g(this);e.preventDefault(),e.stopPropagation();let a=t.data("index");var e=t.data("parent-index"),t=t.parent(),i=t.parent(),n=i.data("target");let l;l=0<g("#"+n+"_attachment_id").length?g("#"+n+"_attachment_id"):g("#"+n+"\\[attachment_id\\]\\["+e+"\\]");var e=g("#"+n+"_copy"),n=e.next(".inputs-wrapper"),d=e.val().split(",");d.splice(a,1),e.val(d.join(",")),0<e.length&&e[0].dispatchEvent(new Event("change")),n.children("input").each(function(){g(this).data("index")===a&&g(this).remove()});let r=[];l.val().split(",").forEach((e,t)=>{t!==a&&r.push(e)}),l.val(r.join(",")),t.remove(),0===i.find(".audio").length&&i.html(`<span class="placeholder">${useTranslation("No file selected")}</span>`)}),g("body").on("click",".upload-image-btn",function(e){var t=g(this);let l=t.prev("input"),d=l.prev("input"),r=t.parent("div");if(e.preventDefault(),e.stopPropagation(),wp&&wp.media){let n=wp.media({title:useTranslation("Upload an Image"),library:{type:["image"]},multiple:!1});n.on("open",function(e){var t,a;""!==d.val()&&(t=n.state().get("selection"),a=wp.media.attachment(d.val()),t.add(a))}),n.on("select",function(e){var t=n.state().get("selection").first(),a=t.toJSON().url,i=t.toJSON().id,t=t.toJSON().name;d.val(i),l.val(a),0<l.length&&l[0].dispatchEvent(new Event("change")),r.prev(".image-preview").html('<div class="image"><img src="'+a+'" alt="'+t+'"/></div>')}),n.open();t=new Event("acpt_media_added");document.dispatchEvent(t)}else alert(useTranslation("The media gallery is not available. You must admin_enqueue this function: wp_enqueue_media()"))}),g("body").on("click",".upload-video-btn",function(e){var t=g(this);let n=t.prev("input"),l=n.prev("input"),d=t.parent("div");if(e.preventDefault(),e.stopPropagation(),wp&&wp.media){let i=wp.media({title:useTranslation("Upload a Video"),library:{type:["video"]},multiple:!1});i.on("open",function(e){var t,a;""!==l.val()&&(t=i.state().get("selection"),a=wp.media.attachment(l.val()),t.add(a))}),i.on("select",function(e){var t=i.state().get("selection").first(),a=t.toJSON().url,t=t.toJSON().id;l.val(t),n.val(a),0<n.length&&n[0].dispatchEvent(new Event("change")),d.prev(".image-preview").html('<div class="image"><video controls><source src="'+a+'" type="video/mp4"></video></div>')}),i.open();t=new Event("acpt_media_added");document.dispatchEvent(t)}else alert(useTranslation("The media gallery is not available. You must admin_enqueue this function: wp_enqueue_media()"))}),g("body").on("click",".upload-gallery-btn",function(e){let r=g(this),o=r.data("parent-index"),s=r.prev(".inputs-wrapper"),c=s.prev("input").prev("input"),p=s.data("target"),v=s.data("target-copy"),u=g("#"+p+"_copy");if(e.preventDefault(),e.stopPropagation(),wp&&wp.media){let d=wp.media({title:useTranslation("Select images"),library:{type:["image"]},button:{text:useTranslation("Add images to the gallery")},multiple:"add"});d.on("open",function(e){if(""!==c.val()){let t=[];var a=d.state().get("selection");c.val().split(",").forEach(e=>{t.push(wp.media.attachment(e))}),a.add(t)}}),d.on("select",function(e){let t=[],a=[],i=[],n=(d.state().get("selection").map(function(e){e.toJSON(),e.attributes.url&&(t.push(e.attributes.id),a.push(e.attributes.url),i.push(e.attributes.name))}),[]),l=(s.html(""),a.map((e,t)=>{var a=v||p;s.append('<input name="'+a+'[]" type="hidden" data-index="'+t+'" value="'+e+'">'),n.push(e)}),"");0<a.length&&r.next("button").removeClass("hidden"),a.map((e,t)=>{l+=`
                    <div class="image" data-index="${t}">
                        <img src="${e}" alt="${i[t]}"/>
                        <a class="delete-gallery-img-btn" data-index="${t}" data-parent-index="${o}" href="#" title="${useTranslation("Delete")}">x</a>
                    </div>
                `}),r.parent("div").prev(".image-preview").html(l),u.val(n.join(",")),0<u.length&&u[0].dispatchEvent(new Event("change")),c.val(t.join(","))}),d.open();e=new Event("acpt_media_added");document.dispatchEvent(e)}else alert(useTranslation("The media gallery is not available. You must admin_enqueue this function: wp_enqueue_media()"))}),g("body").on("click",".delete-gallery-img-btn",function(e){var t=g(this);e.preventDefault(),e.stopPropagation();let a=t.data("index");var e=t.data("parent-index"),t=t.parent(),i=t.parent(),n=i.data("target");let l;l=0<g("#"+n+"_attachment_id").length?g("#"+n+"_attachment_id"):g("#"+n+"\\[attachment_id\\]\\["+e+"\\]");var e=g("#"+n+"_copy"),n=e.next(".inputs-wrapper"),d=e.val().split(",");d.splice(a,1),e.val(d.join(",")),0<e.length&&e[0].dispatchEvent(new Event("change")),n.children("input").each(function(){g(this).data("index")===a&&g(this).remove()});let r=[];l.val().split(",").forEach((e,t)=>{t!==a&&r.push(e)}),l.val(r.join(",")),t.remove(),0===i.find(".image").length&&i.html(`<span class="placeholder">${useTranslation("No image selected")}</span>`)}),(t=null)=>{try{let e=t?"#"+t:"textarea.acpt-codemirror";v(e).length&&v(e).each(function(){let t="#"+g(this).attr("id");if("undefined"!=typeof wp){var a=wp.codeEditor.defaultSettings?_.clone(wp.codeEditor.defaultSettings):{};a.codemirror=_.extend({},a.codemirror,{lineNumbers:!0,indentUnit:2,tabSize:2,mode:"text/html"});let e=wp.codeEditor.initialize(v(t),a);g(document).on("keyup",".CodeMirror-code",function(){g(t).html(e.codemirror.getValue()),g(t).trigger("change")})}else"function"==typeof CodeMirror&&CodeMirror.fromTextArea(document.getElementById(g(this).attr("id")),{lineNumbers:!0,indentUnit:2,tabSize:2,mode:"text/html"})})}catch(e){console.error(e)}}),b=(g(".wppd-ui-toggle").on("change",function(){var e=g(this).attr("id");g("#"+e).val(g(this).is(":checked")?1:0)}),g(".currency-selector").on("change",function(){var e=g(this).find("option:selected"),t=g(this).parent("div").prev();t.prev().text(e.data("symbol")),t.prop("placeholder",e.data("placeholder"))}),(t=null)=>{try{if(jQuery().selectize){let a=(e,t)=>{var a,i,n="<--------\x3e";return e.text.includes(n)?(a=(n=e.text.split(n))[0],i=n[2],`<div class="selectize-item">${a?`<div class="selectize-thumbnail"><img src="${a}" alt="${i}" width="40" /></div>`:'<div class="selectize-thumbnail"><span class="selectize-thumbnail-no-image"></span></div>'}<div class="selectize-details"><span class='acpt-badge'>${n[1]}</span><span>${i}</span></div></div>`):e.image?`<div class="selectize-item"><img src="${e.image}" alt="fdfd" width="50" /><div class="selectize-details"><span>${e.text}</span></div></div>`:`<div>${e.text}</div>`},e=t?"#"+t:".acpt-select2";v(e).selectize({plugins:["restore_on_backspace","clear_button","remove_button"],placeholder:"--Select--",onChange:function(){this.$input[0].dispatchEvent(new Event("change"))},render:{option:function(e,t){return a(e)},item:function(e,t){return a(e)}}})}}catch(e){console.error(e)}}),y=(t=null)=>{try{let e=t?"#"+t:".acpt-color-picker";v(e).length&&"undefined"!=typeof wp&&v(e).wpColorPicker({clear:function(t,e){t=t.target.previousElementSibling.querySelector("input");if(t.classList.contains("acpt-icon-picker-stroke")){var a=t.dataset.targetId,i=/stroke=\"(.*?)\"/gi;let e=g(`.acpt-icon-picker-preview[data-target-id=${a}]`).html();e=e.replaceAll(i,""),g(`.acpt-icon-picker-preview[data-target-id=${a}]`).html(e),g(`.acpt-icon-picker-value[data-target-id="${a}"]`).val(e)}if(t.classList.contains("acpt-icon-picker-fill")){i=t.dataset.targetId,a=/fill=\"(.*?)\"/gi;let e=g(`.acpt-icon-picker-preview[data-target-id=${i}]`).html();e=e.replaceAll(a,""),g(`.acpt-icon-picker-preview[data-target-id=${i}]`).html(e),g(`.acpt-icon-picker-value[data-target-id="${i}"]`).val(e)}},change:function(a,i){a=a.target,i=i.color.toString();if(a.dispatchEvent(new CustomEvent("acpt-icon-picker",{detail:{color:i}})),a.classList.contains("acpt-icon-picker-stroke")){var n=a.dataset.targetId,l=/stroke=\"(.*?)\"/gi;let e=g(`.acpt-icon-picker-preview[data-target-id=${n}]`).html();var d=[...e.matchAll(l)];if(0<d.length){let t=[];d.map(e=>{t.push(e[1])});d=r(t);t.includes("currentColor")?e=e.replace(l,`fill="${i}"`):t.includes("none")||(l=new RegExp('stroke="'+d+'"',"gi"),e=e.replace(l,`stroke="${i}"`))}else e=e.replace("<svg ",`<svg stroke="${i}" `);g(`.acpt-icon-picker-preview[data-target-id=${n}]`).html(e),g(`.acpt-icon-picker-value[data-target-id="${n}"]`).val(e)}if(a.classList.contains("acpt-icon-picker-fill")){d=a.dataset.targetId,l=/fill=\"(.*?)\"/gi;let e=g(`.acpt-icon-picker-preview[data-target-id=${d}]`).html();n=[...e.matchAll(l)];if(0<n.length){let t=[];n.map(e=>{t.push(e[1])});a=r(t);t.includes("currentColor")?e=e.replace(l,`fill="${i}"`):t.includes("none")||(n=new RegExp('fill="'+a+'"',"gi"),e=e.replace(n,`fill="${i}"`))}else e=e.replace("<svg ",`<svg fill="${i}" `);g(`.acpt-icon-picker-preview[data-target-id=${d}]`).html(e),g(`.acpt-icon-picker-value[data-target-id="${d}"]`).val(e)}}})}catch(e){console.error(e)}},l=(g("body").on("click",".acpt-eye-dropper-button",function(e){e.preventDefault();let n=g(this),l=n.data("target-id");l&&(window.EyeDropper?(new EyeDropper).open().then(e=>{e=e.sRGBHex,a=!0;var a,t,i,e="#"+e.replace(/^rgba?\(|\s+|\)$/g,"").split(",").filter((e,t)=>!a||3!==t).map(e=>parseFloat(e)).map((e,t)=>3===t?Math.round(255*e):e).map(e=>e.toString(16)).map(e=>1===e.length?"0"+e:e).join("");t=e,(i=(new Option).style).color=t,""!==i.color?(g("#"+l).val(e),n.prev(".wp-picker-container").find(".wp-color-result").css("background-color",e)):alert(e+" is not a valid CSS color")}).catch(e=>{console.error(e)}):alert("Your browser does not support the EyeDropper API"))}),"https://api.iconify.design/"),w=(g("body").on("click",".acpt-icon-picker-button",function(e){e.preventDefault();e=g(this).data("target-id"),e=g("#"+(e+"_modal"));e.hasClass("hidden")?e.removeClass("hidden"):e.addClass("hidden")}),g("body").on("click",".acpt-icon-picker-selector > li",function(e){e.preventDefault();var e=g(this),t=e.parent("ul"),e=e.data("value");"upload"===e?(t.siblings(".acpt-icon-picker-upload").removeClass("hidden"),t.addClass("hidden")):"browse"===e&&(t.siblings(".acpt-icon-picker-browse").removeClass("hidden"),t.addClass("hidden")),t.prev(".acpt-icon-picker-back").removeClass("hidden")}),g("body").on("click",".acpt-icon-picker-back",function(e){e.preventDefault();var e=g(this),t=e.next("ul");e.addClass("hidden"),t.siblings(".acpt-icon-picker-upload").addClass("hidden"),t.siblings(".acpt-icon-picker-browse").addClass("hidden"),t.removeClass("hidden")}),g("body").on("change",".acpt-icon-picker-size > input",function(e){e.preventDefault();var e=g(this),t=e.data("target-id");let a=g(`.acpt-icon-picker-preview[data-target-id=${t}]`).html();var i=o(a),e=e.val(),i=Math.ceil(e*i),n=/width=\"(.*?)\"/,l=/height=\"(.*?)\"/,d=n.test(a),r=l.test(a);a=d&&r?(a=a.replace(n,`width="${e}px"`)).replace(l,`height="${i}px"`):(a=a.replace("<svg ",`<svg width="${e}px" `)).replace("<svg ",`<svg height="${i}px" `),g(`.acpt-icon-picker-preview[data-target-id=${t}]`).html(a),g(`.acpt-icon-picker-value[data-target-id="${t}"]`).val(a)}),g("body").on("click",".acpt-icon-picker-delete",function(e){e.preventDefault();var e=g(this),t=e.data("target-id");g(`.acpt-icon-picker-preview[data-target-id=${t}]`).html(""),g("#"+t).val(""),e.addClass("hidden"),g(`.acpt-icon-picker-preview-wrapper[data-target-id=${t}]`).addClass("hidden"),g(`.acpt-icon-picker-size[data-target-id=${t}]`).addClass("hidden"),g(`.acpt-icon-picker-stroke[data-target-id=${t}]`).addClass("hidden"),g(`.acpt-icon-picker-fill[data-target-id=${t}]`).addClass("hidden")}),g("body").on("change",".acpt-icon-picker-upload > input",function(e){e.preventDefault();e=g(this);let a=e.data("target-id");e=e.prop("files")[0];let i=new FileReader;i.readAsBinaryString(e),i.onloadend=function(){var e=i.result,e=(new DOMParser).parseFromString(e,"image/svg+xml").querySelector("svg").outerHTML,t=(g(`.acpt-icon-picker-value[data-target-id="${a}"]`).val(e),g("#"+a+"_modal"));g('.acpt-icon-picker-preview[data-target-id="'+a+'"]').html(e),g(`.acpt-icon-picker-preview-wrapper[data-target-id=${a}]`).removeClass("hidden"),g(`.acpt-icon-picker-size[data-target-id=${a}]`).removeClass("hidden"),g(`.acpt-icon-picker-stroke[data-target-id=${a}]`).removeClass("hidden"),g(`.acpt-icon-picker-fill[data-target-id=${a}]`).removeClass("hidden"),g(`.acpt-icon-picker-size[data-target-id=${a}] > input`).val("24"),g(`input.acpt-icon-picker-stroke[data-target-id=${a}]`).val("#777777"),g(`input.acpt-icon-picker-fill[data-target-id=${a}]`).val("#777777"),t.hasClass("hidden")?t.removeClass("hidden"):t.addClass("hidden")}}),g("body").on("click",".acpt-icon-picker-provider",function(e){var t=g(this);t.hasClass("active")?t.removeClass("active"):t.addClass("active");let a=[];g(".acpt-icon-picker-provider.active").each(function(){var e=g(this).data("value");a.push(e)}),g(".acpt-icon-picker-icon").each(function(){var e=g(this).data("prefix"),t=g(this);!(0<a.length)||a.includes(e)?t.removeClass("hidden"):t.addClass("hidden")})}),g("body").on("input",".acpt-icon-picker-search",function(e){var t=g(this),e=e.target.value;let i=t.next(".acpt-icon-picker-results"),n=i.data("target-id");3<=e.length&&g.ajax({type:"GET",url:l+`search?query=${e}&limit=96`,success:function(a){if(i.html(""),a.collections){var e=Object.keys(a.collections).sort();let t='<div class="acpt-icon-picker-providers">';e.forEach(e=>{a.collections[e]&&a.collections[e]?.name&&(t+=`<div data-target-id="${n}" data-value="${e}" class="acpt-icon-picker-provider">${a.collections[e]?.name}</div>`)}),t+="</div>",i.append(t)}0<a.icons.length?a.icons.forEach(e=>{var t=e.split(":"),a=t[0],t=t[1],t=l+a+`/${t}.svg`;i.append(`<div data-target-id="${n}" data-value="${e}" data-prefix="${a}" class="acpt-icon-picker-icon" title="${e}"><img src="${t}" width="32" height="32"></div>`)}):i.append(`<div>${useTranslation("Sorry, no result match.")}</div>`),g(`.acpt-icon-picker-delete[data-target-id="${n}"]`).removeClass("hidden")},error:function(e){console.error(e),i.append(useTranslation("There was an error fetching icons, retry later."))}})}),g("body").on("click",".acpt-icon-picker-icon",function(e){e.preventDefault();var e=g(this),t=e.data("value");let a=e.data("target-id");e=t.split(":"),t=e[0],e=e[1],t=l+t+`/${e}.svg`;g.ajax({type:"GET",url:t,success:function(e){let t=e.children[0].outerHTML;e=o(t),e=Math.ceil(24*e),t=(t=t.replace(/width=\"(.*?)\"/,'width="24px"')).replace(/height=\"(.*?)\"/,`height="${e}px"`),g(`.acpt-icon-picker-value[data-target-id="${a}"]`).val(t),e=g("#"+a+"_modal");g('.acpt-icon-picker-preview[data-target-id="'+a+'"]').html(t),g(`.acpt-icon-picker-preview-wrapper[data-target-id=${a}]`).removeClass("hidden"),g(`.acpt-icon-picker-size[data-target-id=${a}]`).removeClass("hidden"),g(`.acpt-icon-picker-stroke[data-target-id=${a}]`).removeClass("hidden"),g(`.acpt-icon-picker-fill[data-target-id=${a}]`).removeClass("hidden"),g(`.acpt-icon-picker-size[data-target-id=${a}] > input`).val("24"),g(`input.acpt-icon-picker-stroke[data-target-id=${a}]`).val("#777777"),g(`input.acpt-icon-picker-fill[data-target-id=${a}]`).val("#777777"),e.hasClass("hidden")?e.removeClass("hidden"):e.addClass("hidden")},error:function(e){console.error(e),results.append(useTranslation("There was an error fetching icons, retry later."))}})}),g("body").on("click",".close-acpt-icon-picker",function(e){e.preventDefault();e=g(this).data("target-id"),e=g("#"+e);e.hasClass("hidden")?e.removeClass("hidden"):e.addClass("hidden")}),(t=null)=>{try{let e=".acpt-daterangepicker";var a,i,n,l,d,r,o,s,c,p=v(e=t?"#"+t:e);"undefined"!=typeof daterangepicker&&void 0!==p&&(a=e=>e.toISOString().split("T")[0],i=new Date,(n=new Date).setDate(n.getDate()+7),d=(l=p.attr("value"))?l.split(" - ")[0]:a(i),r=l?l.split(" - ")[1]:a(n),o=p.data("max-date"),s=p.data("min-date"),c={drops:"up",startDate:d,endDate:r,locale:{format:"YYYY-MM-DD"}},void 0!==o&&(c.maxDate=o),void 0!==s&&(c.minDate=s),p.daterangepicker(c))}catch(e){console.error(e)}}),k=(t=null)=>{try{let e=".acpt-phone";v(e=t?"#"+t:e).get().forEach(t=>{if("undefined"!=typeof intlTelInput&&void 0!==t){let a=t.previousSibling,i=a.previousSibling,e=i.previousSibling,n=intlTelInput(t,{initialCountry:a.value,separateDialCode:!0,geoIpLookup:t=>{fetch("https://ipapi.co/json").then(e=>e.json()).then(e=>t(e.country_code)).catch(()=>t("us"))},loadUtils:()=>import(e.value)});t.addEventListener("countrychange",function(e){var t=n.getSelectedCountryData();t.iso2&&t.dialCode&&(a.value=t.iso2,i.value=t.dialCode)})}})}catch(e){console.error(e)}},x=(t=null)=>{try{let e=".acpt-country",i=v(e=t?"#"+t:e);if(i.length){let a=i.prev();i.countrySelect({defaultCountry:a.val(),preferredCountries:[]}),i.on("change",e=>{var t=i.countrySelect("getSelectedCountryData");a.val(t.iso2)})}}catch(e){console.error(e)}},C=(t=null)=>{try{let e=".acpt-textarea";var a=v(e=t?"#"+t:e);let i=a.next(".acpt-textarea-ch-counter");a.length&&i.length&&a.on("keyup",function(e){var e=e.target.value.length,t=i.find(".count"),a=parseInt(i.data("max"));e<parseInt(i.data("min"))||a<=e?(t.removeClass("warning"),t.addClass("danger")):a-5<=e?(t.removeClass("danger"),t.addClass("warning")):(t.removeClass("warning"),t.removeClass("danger")),t.text(e)})}catch(e){console.error(e)}},$=(t=null)=>{try{let e=".acpt-embed";var a=v(e=t?"#"+t:e);if(a.length){let t=a.next(".embed-preview");a.on("keyup",debounce(e=>{e=e.target.value;""===e?t.html(""):g.ajax({type:"POST",url:ajaxurl,data:{action:"generateEmbedAction",data:JSON.stringify({value:e})},success:function(e){t&&t.html(`
                                <div class="embed">
                                    ${e.embed}
                                </div>
                            `)},error:function(e){t&&t.html("")},dataType:"json"})},1e3))}}catch(e){console.error(e)}},t=(t=null)=>{try{let e=".acpt-barcode-wrapper";var a=v(e=t?"#"+t:e);"function"==typeof JsBarcode&&a.length&&a.each(function(e){var t=g(this);let i=t.find(".value"),n=t.find(".format"),l=t.find(".color"),d=t.find(".bgColor");var a=t.find(".clear-barcode");let r=t.find(".acpt-barcode-svg"),o=t.find(".acpt-barcode-errors"),s=r.attr("id"),c=g("#barcode_value_"+s.replace("acpt-barcode-","")),p=()=>{r.html(`<svg class="acpt-barcode" id="${s}"></svg>`)},v=()=>{g("#acpt-"+s).removeClass("has-errors"),o.html("")},u=e=>{g("#acpt-"+s).addClass("has-errors"),o.html(e)},h=()=>{p(),i.val(""),n.val("code128"),l.val("#000"),d.val("#fff"),c.val("")};let m=()=>{try{v(),JsBarcode("#"+s,i.val(),{format:n.val()?n.val():"code128",background:d.val()?d.val():"#ffffff",lineColor:l.val()?l.val():"#000000"});var e={svg:(t=g("#"+s)[0].outerHTML,a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},t.replace(/[&<>"']/g,function(e){return a[e]})),format:n.val()?n.val():"code128",bgColor:d.val()?d.val():"#ffffff",color:l.val()?l.val():"#000000"};c.val(JSON.stringify(e))}catch(e){h(),u(`The value "${i.val()}" is not valid for ${n.val()} format`)}var t,a};a.on("click",function(e){e.preventDefault(),h()}),i.on("keyup",debounce(e=>{m()},1e3)),n.on("change",function(e){m()}),l.on("acpt-icon-picker",debounce(e=>{m()},1e3)),d.on("acpt-icon-picker",debounce(e=>{m()},1e3))})}catch(e){console.error(e)}},E=(t=null)=>{try{let e=".acpt-qr-code-wrapper";var a=v(e=t?"#"+t:e);"function"==typeof QRCode&&a.length&&a.each(function(e){var t=g(this);let a=t.find(".url"),i=t.find(".resolution"),n=t.find(".color-dark"),l=t.find(".color-light");var d=t.find(".clear-qr-code");let r=t.find(".acpt-qr-code"),o=r.attr("id"),s=g("#qr_code_value_"+o.replace("acpt-qr-code-","")),c=()=>{r.html("")},p=()=>{c(),a.val(""),i.val(100),n.val("#000"),l.val("#fff"),s.val("")},v=()=>a.is(":valid")&&""!==a.val(),u=()=>{var e;v()?(c(),e=document.getElementById(o),new QRCode(e,{text:a.val(),width:i.val(),height:i.val(),colorDark:n.val()?n.val():"#000000",colorLight:l.val()?l.val():"#ffffff",correctLevel:QRCode.CorrectLevel.H}),e={img:e.children[0].toDataURL("image/png"),resolution:i.val(),colorDark:n.val()?n.val():"#000000",colorLight:l.val()?l.val():"#ffffff"},s.val(JSON.stringify(e))):p()};d.on("click",function(e){e.preventDefault(),p()}),a.on("keyup",debounce(e=>{u()},1e3)),i.on("change",function(e){u()}),n.on("acpt-icon-picker",debounce(e=>{u()},1e3)),l.on("acpt-icon-picker",debounce(e=>{u()},1e3))})}catch(e){console.error(e)}},S=(n,s=8)=>{try{if("undefined"==typeof tinyMCE)console.error("tinyMCE is not defined. Include it here");else{tinyMCE.init(tinyMCEWordpressDefaultSettings(n,s)),tinyMCE.execCommand("mceToggleEditor",!1,n);let l=g("#"+n);var c=l.data("media"),p=g("#loading_"+n);let e=g("#buttons_"+n),d=g("#ch_counter_"+n),r=parseInt(d.data("max")),o=parseInt(d.data("min")),t=tinyMCE.activeEditor,a=(t.on("change",function(e){var t=g(".save-variation-changes");t&&t.removeAttr("disabled")}),p.remove(),l.removeClass("hidden"),""),i=(1!==c&&(a+=`<div id="wp-${n}-media-buttons" class="wp-media-buttons">
                    <button type="button" id="insert-media-button" class="button insert-media add_media" data-editor="${n}">
                        <span class="wp-media-buttons-icon"></span> 
                        ${u("Add Media")}
                    </button>
                </div>`),a+=`
                <div class="wp-editor-tabs">
                    <button type="button" id="${n}-tmce" aria-pressed="true" class="wp-switch-editor switch-tmce" data-wp-editor-id="${n}">
                        ${u("Visual")}
                    </button>
                    <button type="button" id="${n}-html" class="wp-switch-editor switch-html" data-wp-editor-id="${n}">
                        ${u("Text")}
                    </button>
                </div>
            `,e.html(a),()=>{if(r||o){let n=()=>{var e=t.contentDocument.body.innerText;return""===e.trim()?0:e.length},i=()=>{let e;h()?e=g(".editor-post-publish-button__button"):0<g("#publish").length?e=g("#publish"):0<g("#save-option-page").length?e=g("#save-option-page"):0<g("#submit").length?e=g("#submit"):0<g('input[type="submit"]').length&&(e=g('input[type="submit"]'));var t=n(),a=d.next(".acpt-error-list"),i=d.prev(".acpt-wp-editor-wrapper");t<o?(t="Min length "+o,l[0].setCustomValidity(t),l[0].reportValidity(),a.html(`<li>${t}</li>`),i.addClass("has-errors"),e&&e.attr("disabled","disabled")):(l[0].setCustomValidity(""),l[0].reportValidity(),a.html(""),i.removeClass("has-errors"),e&&e.removeAttr("disabled"))};t.on("load",function(e){d.html((()=>{var e=n();let t="";e<o||e>=r?t+="danger":e>=r-5?t+="warning":t="";e=r||"";return`<span class="count ${t}">${n()}</span>/<span class="max">${e}</span> `})()),i()}),t.on("keyup",function(e){var t=n(),a=d.find(".count");t<o||t>=r?(a.removeClass("warning"),a.addClass("danger")):t>=r-5?(a.removeClass("danger"),a.addClass("warning")):(a.removeClass("warning"),a.removeClass("danger")),a.text(t),i()}),t.on("keydown",function(e){return!!["Backspace","Delete","Shift","Control","ArrowLeft","ArrowRight"].includes(e.key)||!(n()>=r&&(e.preventDefault(),e.stopPropagation(),1))})}});if(i(),h()){let e=setTimeout(function(){l.prev(".mce-tinymce").find("iframe").contents().find("body").attr("contenteditable")?clearTimeout(e):(console.log("tinyMCE was not properly initialized, I am trying to restart it once again..."),tinyMCE.execCommand("mceRemoveEditor",!1,n),tinyMCE.init(tinyMCEWordpressDefaultSettings(n,s)),tinyMCE.execCommand("mceToggleEditor",!1,n),i())},4e3)}}}catch(e){console.error(e),buttons.remove()}},i=e=>{try{"undefined"==typeof tinyMCE?console.error("tinymce is not defined. Include it here"):tinyMCE.execCommand("mceRemoveEditor",!1,e)}catch(e){console.error(e)}},D=()=>{if("function"==typeof ACPTFormValidator){let e=null;switch(adminpage){case"user-edit-php":case"edit-tags-php":e="add-tax";break;case"post-php":e="save-cpt";break;case"term-php":e="edit-tax";break;case"admin-php":e="save-option-page"}new ACPTFormValidator(e).run()}};function a(){var e;(e=g("textarea.acpt-wp-editor"))&&0<e.length&&e.each(function(e,t){S(t.id,t.getAttribute("rows"))}),b(),f(),y(),m(),w(),k(),x(),E(),t(),$(),C(),(e=localStorage.getItem("acpt_fields_visibility"))&&JSON.parse(e).map(e=>{let l=g(`ul.acpt-sortable[data-conditional-rules-id="${e.id}"]`);e.vis.map((e,t)=>{var a,i,n,t=l.find("li")[t];t&&(a=t.id.includes("block-")?"collapsed":"hidden",i=t.querySelector(".li_toggle_visibility"),n=t.querySelector(".sortable-li_toggle_visibility"),!0===e?(i&&i.classList.remove("reverse"),n&&n.classList.remove("reverse"),t.classList.remove(a)):(i&&i.classList.add("reverse"),n&&n.classList.add("reverse"),t.classList.add(a)))})}),["acpt_grouped_element_removed","acpt_grouped_element_added","acpt_grouped_element_sorted","acpt_grouped_element_toggle_visibilty"].map(e=>{document.addEventListener(e,()=>{var e=g(".acpt-sortable");let d=[];e&&0<e.length&&e.each(function(e,t){var a=t.dataset.conditionalRulesId,i=t.querySelectorAll("li"),n=[];for(e=0;e<i.length;++e){var l=i[e],l=l.classList.contains("hidden")||l.classList.contains("collapsed");n.push(!l)}d.push({id:a,vis:n})}),localStorage.setItem("acpt_fields_visibility",JSON.stringify(d))})})}g(".acpt-reset-map").on("click",function(e){e.preventDefault();var e=g(this).parent();let i;e.find("input").each(function(){var e=g(this),t=e.attr("id"),a=e.attr("type");t&&("text"===a&&(i=t),e.val(""))}),i&&(e=new CustomEvent("acpt-reset-map",{detail:{fieldId:i+"_map"}}),document.dispatchEvent(e))}),g(".acpt-admin-horizontal-tab").on("click",function(e){e.preventDefault();var e=g(this),t=e.parent(),a=e.data("target"),i=g("#"+a).parent();t.children().removeClass("active"),i.children().removeClass("active"),g("#"+a).addClass("active"),e.addClass("active")}),g(".acpt-admin-vertical-tab").on("click",function(e){e.preventDefault();var e=g(this),t=e.parent(),a=e.data("target"),i=g("#"+a).parent();t.children().removeClass("active"),i.children().removeClass("active"),g("#"+a).addClass("active"),e.addClass("active")}),g(".acpt-admin-accordion-title").on("click",function(e){e.preventDefault();var e=g(this).parent("div"),t=e.parent("div"),a=e.hasClass("active");t.children().each(function(){g(this).removeClass("active")}),a?e.removeClass("active"):e.addClass("active")});var d=g(".attachments-wrapper");d&&g(d).on("click",function(e){a()}),g("body").on("click",".woocommerce_variation.wc-metabox > h3",function(e){a(),g(this).parent().addClass("variation-needs-update")}),g(document).on("woocommerce_variations_loaded",function(e){var t=g(".woocommerce_variations");0<t.length&&t.find(".acpt-select2").each(function(e,t){g(this).removeClass("acpt-select2")})}),a()});