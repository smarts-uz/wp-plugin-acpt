window.onload=function(){function f(t,n=300){let a;return(...e)=>{clearTimeout(a),a=setTimeout(()=>{t.apply(this,e)},n)}}function r(e){let t=e.replaceAll("[","\\[");return t=t.replaceAll("]","\\]")}let u=()=>{var r=document.getElementsByClassName("acpt-phone");if(0<r.length)for(let t=0;t<r.length;t++){var o=r.item(t);let n=document.getElementById(o.id+"_country"),a=document.getElementById(o.id+"_dial"),e=document.getElementById(o.id+"_utils"),l=intlTelInput(o,{initialCountry:n.value,separateDialCode:!0,geoIpLookup:t=>{fetch("https://ipapi.co/json").then(e=>e.json()).then(e=>t(e.country_code)).catch(()=>t("us"))},loadUtils:()=>import(e.value)});o.addEventListener("countrychange",function(e){var t=l.getSelectedCountryData();t.iso2&&t.dialCode&&(n.value=t.iso2,a.value=t.dialCode)})}},m=(u(),()=>{var t=document.getElementsByClassName("acpt-textarea");if(0<t.length)for(let e=0;e<t.length;e++){var n=t.item(e);let a=n.nextElementSibling;n.addEventListener("keyup",function(e){var e=e.target.value.length,t=a.querySelector(".count"),n=parseInt(a.dataset.max);e<parseInt(a.dataset.min)||n<=e?(t.classList.remove("warning"),t.classList.add("danger")):n-5<=e?(t.classList.remove("danger"),t.classList.add("warning")):(t.classList.remove("warning"),t.classList.remove("danger")),t.textContent=e})}}),g=(m(),()=>{var t=document.getElementsByClassName("acpt-delete-file"),n=document.getElementsByClassName("acpt-file");if(0<t.length)for(let e=0;e<t.length;e++){let n=t.item(e),a=n.dataset.target,l=n.dataset.value;n.addEventListener("click",function(e){e.preventDefault();var e=document.getElementById(a),t=e.value.split(",").filter(e=>e!==l);e.value=t.join(","),n.parentElement.remove()})}if(0<n.length)for(let e=0;e<n.length;e++){var a=n.item(e);let t=a.dataset.targetId;a.addEventListener("change",function(e){document.getElementById(t).value=""})}}),v=(g(),()=>{var n=document.getElementsByClassName("acpt-color-picker");if(0<n.length)for(let e=0;e<n.length;e++){var a=n.item(e),l=a.querySelector("input");let t=a.querySelector(".color_val");l&&l.addEventListener("change",function(e){t.innerHTML=e.target.value})}}),p=(v(),()=>{var t=document.getElementsByClassName("acpt-select2");if("function"==typeof Choices&&0<t.length)for(let e=0;e<t.length;e++){var n=t.item(e);n&&new Choices(n,{classNames:{containerInner:["acpt-form-control"],listItems:["choices__list","acpt-choices__list--multiple"],listSingle:["choices__list","acpt-choices__list--single"]}})}}),h=(p(),()=>{if("function"==typeof IconPicker){var a=document.getElementsByClassName("acpt-iconpicker");if(0<a.length)for(let e=0;e<a.length;e++){var l=a.item(e).dataset.target,r=new IconPicker(a.item(e),{theme:"bootstrap-5",iconSource:["Iconoir","FontAwesome Solid 6"],closeOnSelect:!0});let t=document.getElementById(l+"_target"),n=document.getElementById(l+"_svg");r.on("select",e=>{""!==t.innerHTML&&(t.innerHTML=""),t.className="acpt-selected-icon "+e.name,t.innerHTML=e.svg,n.value=e.svg})}}}),y=(h(),()=>{if("function"==typeof CodeMirror){var t=document.getElementsByClassName("acpt-codemirror");if(0<t.length)for(let e=0;e<t.length;e++){var n=t.item(e);n.nextElementSibling.classList.contains("CodeMirror")||CodeMirror.fromTextArea(n,{indentUnit:2,tabSize:2,mode:"htmlmixed",lineNumbers:!0})}}}),E=(y(),()=>{if("function"==typeof JsBarcode){var m=document.getElementsByClassName("acpt-barcode-wrapper");if(0<m.length)for(let n=0;n<m.length;n++){var g=m.item(n);let a=g.querySelector(".value"),l=g.querySelector(".format"),r=g.querySelector(".color"),o=g.querySelector(".bgColor");var v=g.querySelector(".clear-barcode");let e=g.querySelector(".acpt-barcode-svg"),i=g.querySelector(".acpt-barcode-errors"),d=e.id,c=document.getElementById("acpt-barcode-"+d),s=document.getElementById("barcode_value_"+d.replace("acpt-barcode-","")),u=()=>{e.innerHTML=`<svg class="acpt-barcode" id="${d}"></svg>`,a.value="",l.value="code128",r.value="#000000",o.value="#ffffff",s.value=""};let t=()=>{try{c.classList.remove("has-errors"),i.innerHTML="",console.log(d,a.value),JsBarcode("#"+d,a.value,{format:l.value||"code128",background:o.value||"#ffffff",lineColor:r.value||"#000000"});var e={svg:(t=c.outerHTML,n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},t.replace(/[&<>"']/g,function(e){return n[e]})),format:l.value||"code128",bgColor:o.value||"#ffffff",color:r.value||"#000000"};s.value=JSON.stringify(e)}catch(e){console.log(e),u(),t=`The value "${a.value}" is not valid for ${l.value} format`,console.log(c),c.classList.add("has-errors"),i.innerHTML=t}var t,n};v.addEventListener("click",function(e){e.preventDefault(),u()}),a.addEventListener("keyup",f(e=>{t()},1e3)),l.addEventListener("change",function(e){t()}),r.addEventListener("change",f(e=>{t()},1e3)),o.addEventListener("change",f(e=>{t()},1e3))}}}),L=(E(),()=>{if("function"==typeof QRCode){var u=document.getElementsByClassName("acpt-qr-code-wrapper");if(0<u.length)for(let s=0;s<u.length;s++){var m=u.item(s);let t=m.querySelector(".url"),n=m.querySelector(".resolution"),a=m.querySelector(".color-dark"),l=m.querySelector(".color-light");var g=m.querySelector(".clear-qr-code");let e=m.querySelector(".acpt-qr-code"),r=e.id,o=document.getElementById("qr_code_value_"+r.replace("acpt-qr-code-","")),i=()=>{e.innerHTML=""},d=()=>{i(),t.value="",n.value=100,a.value="#000000",l.value="#ffffff",o.value=""},c=()=>{var e;(e=>{try{return Boolean(new URL(e))}catch(e){return!1}})(t.value)?(i(),e=document.getElementById(r),new QRCode(e,{text:t.value,width:n.value,height:n.value,colorDark:a.value||"#000000",colorLight:l.value||"#ffffff",correctLevel:QRCode.CorrectLevel.H}),e={img:e.children[0].toDataURL("image/png"),resolution:n.value,colorDark:a.value||"#000000",colorLight:l.value||"#ffffff"},o&&(o.value=JSON.stringify(e))):d()};g.addEventListener("click",function(e){e.preventDefault(),d()}),t.addEventListener("keyup",f(e=>{c()},1e3)),n.addEventListener("change",function(e){c()}),a.addEventListener("change",f(e=>{c()},1e3)),l.addEventListener("change",f(e=>{c()},1e3))}}}),S=(L(),()=>{if("function"==typeof Quill){var t=document.getElementsByClassName("acpt-quill");if(0<t.length)for(let e=0;e<t.length;e++){let d=t.item(e),c=document.getElementById(d.id+"_hidden");var n=c.closest("form");let s=n.querySelector('[type="submit"]'),u=d.nextElementSibling,m=u.nextElementSibling,g=parseInt(u.dataset.max),v=parseInt(u.dataset.min);var a=parseInt(d.dataset.rows);parseInt(d.dataset.cols);if(!d.previousElementSibling.classList.contains("ql-toolbar")){let o=()=>{var e="Min length "+v;c.setCustomValidity(e),c.reportValidity(),d.classList.add("invalid"),m&&(m.innerHTML=`<li>${e}</li>`),s&&(s.disabled=!0)},i=new Quill("#"+r(d.id),{modules:{toolbar:[["bold","italic"],["link","blockquote","code-block","image"],[{list:"ordered"},{list:"bullet"}]]},theme:"snow"});var l=document.getElementById(""+r(d.id));l&&(l.querySelector(".ql-editor").style.height=25*a+"px"),s&&s.addEventListener("click",function(e){i.getLength()-1<v&&(e.preventDefault(),o())}),n.addEventListener("submit",function(e){i.getLength()-1<v&&(e.preventDefault(),o())}),i.on("text-change",function(e,t,n){i.getText();var a=i.getLength()-1,l=i.container.firstChild.innerHTML,r=u.querySelector(".count");c&&(a<v?o():(c.setCustomValidity(""),c.reportValidity(),d.classList.remove("invalid"),m&&(m.innerHTML=""),s&&(s.disabled=!1)),a>=g&&i.history.undo(),r&&(a<v||a>=g?(r.classList.remove("warning"),r.classList.add("danger")):a>=g-5?(r.classList.remove("danger"),r.classList.add("warning")):(r.classList.remove("warning"),r.classList.remove("danger")),r.textContent=a),c.value=l)})}}}});S();(()=>{var t=document.getElementsByClassName("list-add-element");if(0<t.length)for(let e=0;e<t.length;e++){let l=t.item(e);l.addEventListener("click",function(e){e.preventDefault();var e=l.dataset.targetId,t=l.dataset.parentName,e=document.getElementById(e),n=e.children.length,a=document.createElement("div");a.classList.add("actp-form-inline"),a.id=t+"_"+n,a.insertAdjacentHTML("beforeend",`
                        <input
                                id='${t}_${n}' 
                                name='${t}[]' 
                                type='text'
                                class="actp-form-control"
                            />
                            <a 
                                class='list-remove-element' 
                                data-target-id='${t}_${n}' 
                                href='#'
                                title='Remove element'
                            >
                                <svg xmlns='http://www.w3.org/2000/svg' 
                                    width='24' 
                                    height='24' 
                                    viewBox='0 0 24 24' 
                                    style='fill: rgba(0, 0, 0, 1);transform: ;msFilter:;'
                                >
                                    <path d='M7 11h10v2H7z'></path>
                                    <path d='M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z'></path>
                                </svg>
                            </a>
                    `),e.append(a),r()})}let r=()=>{var n=document.getElementsByClassName("list-remove-element");if(0<n.length)for(let e=0;e<n.length;e++){let t=n.item(e);t.addEventListener("click",function(e){e.preventDefault();e=t.dataset.targetId,e=document.getElementById(e);e&&e.remove()})}};r()})();(()=>{var t=document.getElementsByClassName("add-grouped-element");if(0<t.length)for(let e=0;e<t.length;e++){let d=t.item(e);d.addEventListener("click",function(e){e.preventDefault();var e=d.dataset.groupId,t=d.dataset.layout,n=d.dataset.mediaType,a=d.dataset.parentIndex,l=d.dataset.parentName,r=d.dataset.formId;let o=document.querySelectorAll('[data-message-id="'+e+'"]'),i=document.getElementById(e);n={id:e,mediaType:n,layout:t,index:c(e,t),parentName:l,parentIndex:a,frontEnd:!0,formId:r};e="generateGroupedFieldsAction",t=document.location.origin+document.globals.ajax_url,e={action:e,data:JSON.stringify(n)},fetch(t,{method:"POST",body:new URLSearchParams(e).toString(),headers:{"Content-type":"application/x-www-form-urlencoded"}}).then(e=>e.text()).then(e=>{e=JSON.parse(e);if(e.fields){i.insertAdjacentHTML("beforeend",e.fields),s(),g(),m(),u(),h(),y(),S(),E(),L(),v(),p();e=new Event("acpt_grouped_element_added");if(document.dispatchEvent(e),o)for(let e=0;e<o.length;e++)o.item(e).remove()}}).catch(e=>{console.error(e)})})}let c=(e,t)=>{e=document.getElementById(e);let n=0;return n=e?("table"===t?e.querySelectorAll("tr.sortable-li"):e.querySelectorAll("li")).length:n},s=()=>{var t=document.getElementsByClassName("remove-grouped-element");if(0<t.length)for(let e=0;e<t.length;e++){let s=t.item(e);s.addEventListener("click",function(e){e.preventDefault();var e=s.dataset.parentId,t=s.dataset.targetId,n=s.dataset.layout,a=s.dataset.element,t=(s.dataset.elements,document.getElementById(t)),l=t.parentNode;l.id,l.dataset.minBlocks;let r=l.dataset.maxBlocks,o=("table"===n?l.querySelectorAll("tr"):l.querySelectorAll("li")).length,i=document.querySelector(`.add-grouped-element[data-group-id="${e}"]`),d=()=>void 0===r||o<r;t.remove(),d()?i.removeAttribute("disabled"):i.setAttribute("disabled","disabled");let c;0===(c="table"===n?l.querySelectorAll("tr").length-1:l.querySelectorAll("li").length)&&(l.innerHTML=`<p data-message-id="${e}" class="update-nag notice notice-warning inline no-records">${`No fields saved, generate the first one clicking on "Add ${a}" button`}</p>`);t=new Event("acpt_grouped_element_removed");document.dispatchEvent(t)})}};s()})()};