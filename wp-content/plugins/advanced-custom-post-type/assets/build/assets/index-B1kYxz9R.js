import{j as e,u as a,d as y}from"./fields-Uuj9pZLj.js";import{a as f,h as X,R,L as H,u as z}from"./vendor-D21mNUGX.js";import{s as S,n as T,B as E,D as J,a as I,f as K,L as Z}from"./Layout-CbPpDR-w.js";import{P as g,u as w,b as N,B as _,s as n,aJ as Q,r as O,w as M,A as ee,I as se,p as te,aK as re,a as ae,m as ne,c as le,ac as ie,L as ce,q as P,t as oe}from"./index-DW87FRXD.js";import{B as v}from"./index-DU1xUoYR.js";import{M as C}from"./index-mrXLwnSf.js";import{u as F,a as de,b as ue,F as he}from"./index.esm-DCQn2FO4.js";import{m as d}from"./metaTypes-Bb9tjSPe.js";import{C as pe}from"./index-DbbBejw-.js";import{P as me}from"./index-DfOJf81u.js";import{B as xe}from"./index-C2f65238.js";import{u as fe}from"./index-DRV1MUeg.js";import"./index-kc5wfrYu.js";const G=({page:t,id:p})=>{const l=document.globals.settings,{reset:u}=F(),o=w();l.length>0&&N(l,"key","records_per_page")!==""&&N(l,"key","records_per_page").value;const[i,m]=f.useState(!1),r=X(),s=()=>{o(Q(p)).then(x=>{const A=x.payload;A.success?(u(),r("/meta"),m(!i),S("Meta group successfully deleted."),O()):T.error(A.error)}).catch(x=>console.error(x))},h=[e.jsx(_,{style:n.DANGER,onClick:()=>{s()},children:a("Yes, delete it")}),e.jsx(_,{style:n.SECONDARY,onClick:()=>{m(!i)},children:a("Return back to list")})];return e.jsxs(R.Fragment,{children:[e.jsx(C,{title:a("Delete meta group"),buttons:h,visible:i,children:e.jsx("div",{children:a("You are going to delete this meta group. Are you sure?")})}),e.jsx("a",{className:`color-${n.DANGER}`,href:"#",onClick:x=>{x.preventDefault(),m(!i)},children:a("Delete")})]})};G.propTypes={page:g.number.isRequired,id:g.string.isRequired};const L=({belongsTo:t,find:p})=>{const[j,l]=f.useState(p);let u=n.SECONDARY;return(t===d.TAXONOMY||t==="TERM_ID")&&(u=n.WARNING),t===d.OPTION_PAGE&&(u=n.INFO),t===d.COMMENT&&(u=n.BORDERED),t==="USER_ID"&&(u=n.DANGER),(t==="PARENT_POST_ID"||t==="POST_ID"||t==="POST_TAX"||t==="POST_CAT"||t==="POST_TEMPLATE"||t==="TERM_ID"||t==="USER_ID")&&(()=>{M("fetchFindAction",{belongsTo:t,id:p}).then(i=>{l(i)}).catch(i=>{console.error(i.message)})})(),t===d.USER?e.jsx(E,{style:n.DANGER,children:a("User")}):e.jsx(E,{style:u,children:j})};L.propTypes={belongsTo:g.string.isRequired,find:g.string.isRequired};const B=({belongs:t})=>{const j=document.globals.globals,[l,u]=f.useState(!1),o=r=>{if(!r.belongsTo)return"";let s="";switch(r.belongsTo){case d.CUSTOM_POST_TYPE:s="Custom post type";break;case d.TAXONOMY:s="Taxonomy";break;case d.OPTION_PAGE:s="Option page";break;case d.USER:s="All users";break;case d.COMMENT:s="All comments";break;case d.MEDIA:s="Attachment";break;case"PARENT_POST_ID":s="Post parent";break;case"POST_ID":s="Post";break;case"POST_TEMPLATE":s="Post template";break;case"POST_TAX":s="Post taxonomy";break;case"POST_CAT":s="Post category";break;case"TERM_ID":s="Term";break;case"USER_ID":s="User";break}return a(s)},i=r=>{if(!r.operator)return"";let s="";switch(r.operator){case"=":s="is equal to";break;case"!=":s="is not equal to";break;case"IN":s="is included in";break;case"NOT_IN":s="is not included in";break}return a(s)},m=r=>{if(!r.find||r.find==="")return"";const s=r.find.split(",");return s.length>0?e.jsx("div",{className:"i-flex-center flex-wrap s-4",children:s.map(h=>e.jsx(L,{belongsTo:r.belongsTo,find:h}))}):""};return e.jsxs(R.Fragment,{children:[e.jsx(C,{title:a("Location"),visible:l,textAlign:"left",children:(t==null?void 0:t.length)>0?e.jsx("div",{className:"responsive",children:e.jsx("table",{className:`acpt-table spaceless ${j.is_rtl?"rtl":""}`,children:e.jsx("tbody",{children:t.map((r,s)=>{const h=s===t.length-1;return e.jsxs("tr",{children:[e.jsx("td",{children:o(r)}),e.jsx("td",{children:i(r)}),e.jsx("td",{children:m(r)}),e.jsx("td",{children:!h&&r.logic&&a(r.logic)})]})})})})}):e.jsx(ee,{style:n.SECONDARY,children:a("No conditions are present.")})}),e.jsx("a",{href:"#",onClick:r=>{r.preventDefault(),u(!l)},children:a("Show")})]})};B.propTypes={belongs:g.array.isRequired};const U=({id:t})=>{const[p,j]=f.useState({}),[l,u]=f.useState(!1);return f.useEffect(()=>{l===!0&&M("exportCodeAction",{belongsTo:d.META,find:t}).then(o=>{j(o)}).catch(o=>{console.error(o.message)})},[l]),e.jsxs(R.Fragment,{children:[e.jsx(C,{title:a("Export code"),visible:l,textAlign:"left",children:e.jsx(pe,{language:"php",code:p.acpt,editable:!1})}),e.jsx("a",{href:"#",onClick:o=>{o.preventDefault(),u(!l)},children:a("Export code")})]})};U.propTypes={id:g.string.isRequired};const q=f.memo(({record:t,page:p})=>{const{register:j}=F(),l=`elements.${t.id}`,u=()=>{M("duplicateAction",{belongsTo:d.META,find:t.id}).then(r=>{r.success===!0?(S("Meta group successfully duplicated."),I(),O()):T.error(r.error)}).catch(r=>{console.error(r),T.error(a("Unknown error, please retry later"))})},o=r=>{let s,h;switch(r){default:case y.STANDARD:s=n.INFO,h=a("Standard view");break;case y.ACCORDION:s=n.SUCCESS,h=a("Accordion");break;case y.HORIZONTAL_TABS:s=n.WARNING,h=a("Horizontal tabs");break;case y.VERTICAL_TABS:s=n.DANGER,h=a("Vertical tabs");break}return!s||!h?null:e.jsx(E,{style:s,children:h})},i=r=>{let s;switch(r){case"advanced":s=n.SUCCESS;break;case"normal":s=n.INFO;break;case"side":s=n.DANGER;break}return s?e.jsx(E,{style:s,children:r}):null},m=r=>{let s;switch(r){case"default":s=n.SUCCESS;break;case"core":s=n.INFO;break;case"high":s=n.WARNING;break;case"low":s=n.DANGER;break}return s?e.jsx(E,{style:s,children:r}):null};return e.jsx(R.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{style:{width:"24px"},children:e.jsxs("label",{className:"checkbox",htmlFor:l,children:[e.jsx("input",{type:"checkbox",id:l,name:l,defaultChecked:!1,...j(l)}),e.jsx("span",{})]})}),e.jsx("td",{children:t.name}),e.jsx("td",{children:t.label}),e.jsx("td",{children:o(t.display)}),e.jsx("td",{children:i(t.context)}),e.jsx("td",{children:m(t.priority)}),e.jsx("td",{children:e.jsx(B,{belongs:t.belongs})}),e.jsx("td",{children:t.fieldsCount}),e.jsx("td",{children:e.jsx(J,{name:"meta-field-menu",buttonClass:n.SECONDARY,anchor:e.jsx(se,{icon:"bx:dots-vertical-rounded",color:te(),width:24}),links:[e.jsx(H,{to:`/edit_meta/${t.id}`,children:a("Edit")}),e.jsx("a",{href:"#",onClick:r=>{r.preventDefault(),u()},children:a("Duplicate")}),e.jsx(G,{id:t.id,page:p}),e.jsx(U,{id:t.id})]})})]})})});q.propTypes={page:g.number.isRequired,record:g.object.isRequired};const je=()=>{const t=document.globals,p=t.settings,j=t.globals;re(d.CUSTOM_POST_TYPE);const[l,u]=f.useReducer(c=>c+1,0);fe();const o=f.useRef(),i=de({mode:"all"}),m=ue({control:i.control,name:"elements"}),r=w(),{data:s,loading:h}=ae(c=>c.fetchMeta),{page:x}=z(),A=p.length>0&&N(p,"key","records_per_page")!==""?N(p,"key","records_per_page").value:20,D=Math.ceil(s.count/A);f.useEffect(()=>{ne(a("Field groups")),le("#/meta"),r(ie({page:x||1,perPage:A})).then(c=>{K()})},[x]),f.useEffect(()=>{(()=>{if(!m)return!1;let b=0;for(const[k,W]of Object.entries(m))W===!0&&b++;return b===Object.entries(m).length})()?o.current.checked=!0:o.current&&(o.current.checked=!1)},[m]),document.addEventListener("restoredElement",function(){u()});const Y=c=>{i.reset(),c.belongsTo=d.META;const b=c.action;if(b)switch(b){case"hide":oe(c);break;case"delete":case"duplicate":M("bulkActionsAction",c).then(k=>{if(k.success===!0){switch(c.action){case"delete":S("Meta group successfully deleted.");break;case"duplicate":S("Meta group successfully duplicated.");break}i.resetField("elements"),I(),O()}else T.error(k.error)}).catch(k=>{console.error(k),T.error(a("Unknown error, please retry later"))});break}},V=c=>{s.records.filter(b=>!P(b.id,d.META)).map(b=>{i.setValue(`elements.${b.id}`,c)})},$=[e.jsx(v,{style:n.PRIMARY,to:"/register_meta",children:a("Create new Meta group")})];return h?e.jsx(ce,{}):e.jsx(he,{...i,children:e.jsx("form",{onSubmit:i.handleSubmit(Y),children:e.jsxs(Z,{title:a("Field groups"),actions:$,crumbs:[{label:a("Field groups")}],children:[e.jsx(xe,{belongsTo:d.META}),s.records&&s.records.length>0?e.jsx("div",{className:"responsive with-shadow b-rounded",children:e.jsxs("table",{className:`acpt-table rounded ${j.is_rtl?"rtl":""}`,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"24px"},children:e.jsxs("label",{className:"checkbox",htmlFor:"all",children:[e.jsx("input",{ref:o,type:"checkbox",id:"all",defaultChecked:!1,onClick:c=>V(c.currentTarget.checked)}),e.jsx("span",{})]})}),e.jsx("th",{children:a("Group name")}),e.jsx("th",{children:a("Group label")}),e.jsx("th",{children:a("Display as")}),e.jsx("th",{children:a("Context")}),e.jsx("th",{children:a("Priority")}),e.jsx("th",{children:a("Location")}),e.jsx("th",{children:a("Fields count")}),e.jsx("th",{children:a("Actions")})]})}),e.jsx("tbody",{children:s.records&&s.records.map(c=>{if(!P(c.id,d.META))return e.jsx(q,{page:x,record:c},c.id)})}),D>1&&e.jsx("tfoot",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:9,children:e.jsx(me,{currentPage:x?parseInt(x):1,totalPages:D,baseLink:"/meta"})})})})]})}):e.jsx("div",{className:"p-24 bg-white with-shadow",children:e.jsxs("div",{className:"b-maxi b-rounded p-24 flex-column s-12 text-center",children:[e.jsx("span",{children:a("No meta group found.")}),e.jsx("div",{children:e.jsx(v,{type:"button",style:n.SECONDARY,to:"/register_meta",children:a("Create new Meta group")})})]})})]})})})};je.propTypes={};export{je as default};
