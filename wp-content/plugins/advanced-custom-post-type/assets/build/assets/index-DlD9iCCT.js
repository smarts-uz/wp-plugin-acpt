import{j as e,u as t}from"./fields-Uuj9pZLj.js";import{a as g,h as K,R as _,L as P,u as z}from"./vendor-D21mNUGX.js";import{s as k,n as f,D as S,a as L,f as J,L as Q}from"./Layout-CbPpDR-w.js";import{P as E,u as $,b as N,B as R,s as x,bW as X,r as C,I as w,p as I,q as O,w as q,aK as Z,a as ee,m as se,c as te,ad as ne,L as ae,t as ie}from"./index-DW87FRXD.js";import{B as D}from"./index-DU1xUoYR.js";import{T}from"./index-D3iHHJgH.js";import{P as oe}from"./index-DfOJf81u.js";import{F as G,E as M}from"./FieldGroupsModal-BkHvLyRt.js";import{m as l}from"./metaTypes-Bb9tjSPe.js";import{E as le}from"./index-CKuX73qi.js";import{E as F}from"./index-n0xjyagi.js";import{u as B,a as re,b as ce,F as de}from"./index.esm-DCQn2FO4.js";import{M as ue}from"./index-mrXLwnSf.js";import{B as pe}from"./index-C2f65238.js";import{u as me}from"./index-DRV1MUeg.js";import"./index-Cwt3Qm9G.js";import"./index-CTmKXGMM.js";import"./index-DbbBejw-.js";import"./index-kc5wfrYu.js";const v=({page:n,id:u})=>{const o=document.globals.settings,{reset:c}=B(),s=$();o.length>0&&N(o,"key","records_per_page")!==""&&N(o,"key","records_per_page").value;const[i,y]=g.useState(!1),p=K(),A=()=>{s(X(u)).then(h=>{const j=h.payload;j.success?(c(),k("Option page successfully deleted."),p("/option-pages"),C()):f.error(j.error)}).catch(h=>console.error(h))},m=[e.jsx(R,{style:x.DANGER,onClick:()=>{A()},children:t("Yes, delete it")}),e.jsx(R,{style:x.SECONDARY,onClick:()=>{y(!i)},children:t("Return back to list")})];return e.jsxs(_.Fragment,{children:[e.jsx(ue,{title:t("Delete meta group"),buttons:m,visible:i,children:e.jsx("div",{children:t("You are going to delete this option page. Are you sure?")})}),e.jsx("a",{className:`color-${x.DANGER}`,href:"#",onClick:h=>{h.preventDefault(),y(!i)},children:t("Delete")})]})};v.propTypes={page:E.number.isRequired,id:E.string.isRequired};const Y=g.memo(({record:n,page:u})=>{const{register:b}=B(),o=s=>`elements.${s}`,c=s=>{q("duplicateAction",{belongsTo:l.OPTION_PAGE,find:s}).then(i=>{i.success===!0?(k("Option pages successfully duplicated."),L(),C()):f.error(i.error)}).catch(i=>{console.error(i),f.error(t("Unknown error, please retry later"))})};return e.jsxs(_.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{width:"24px"},children:e.jsxs("label",{className:"checkbox",htmlFor:o(n.id),children:[e.jsx("input",{type:"checkbox",id:o(n.id),name:o(n.id),defaultChecked:!1,...b(o(n.id))}),e.jsx("span",{})]})}),e.jsx("td",{"data-cy":"page-icon",children:e.jsx(le,{value:n.icon})}),e.jsx("td",{"data-cy":"page-title",children:n.pageTitle}),e.jsx("td",{"data-cy":"page-type",children:e.jsx(F,{element:n})}),e.jsx("td",{"data-cy":"menu-title",children:n.menuTitle}),e.jsx("td",{"data-cy":"menu-slug",children:n.menuSlug}),e.jsx("td",{"data-cy":"position",children:n.position}),e.jsx("td",{children:e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx(P,{to:`/register_meta?belongsTo=${l.OPTION_PAGE}&find=${n.menuSlug}`,children:t("Create")}),e.jsx(G,{find:n.menuSlug,belongsTo:l.OPTION_PAGE})]})}),e.jsx("td",{children:e.jsx(S,{name:"option-page-menu",buttonClass:x.SECONDARY,anchor:e.jsx(w,{icon:"bx:dots-vertical-rounded",color:I(),width:24}),links:[e.jsx("a",{href:"#",onClick:s=>{s.preventDefault(),c(n.id)},children:t("Duplicate")}),e.jsx(v,{page:u,id:n.id}),e.jsx(M,{belongsTo:l.OPTION_PAGE,find:n.menuSlug}),e.jsx(P,{to:`/permissions/page/${n.menuSlug}/${n.id}`,className:"color-warning",children:t("Permissions")})]})})]}),n.children&&n.children.length>0&&n.children.map(s=>{if(!O(s.id,l.OPTION_PAGE))return e.jsx(_.Fragment,{children:e.jsxs("tr",{children:[e.jsx("td",{style:{width:"24px"},children:e.jsxs("label",{className:"checkbox",htmlFor:o(s.id),children:[e.jsx("input",{type:"checkbox",id:o(s.id),name:o(s.id),defaultChecked:!1,...b(o(s.id))}),e.jsx("span",{})]})}),e.jsx("td",{}),e.jsx("td",{"data-cy":"page-title",children:e.jsxs("span",{className:"i-flex-center s-8",children:[e.jsx("span",{className:"line"}),e.jsx("span",{children:s.pageTitle})]})}),e.jsx("td",{"data-cy":"page-type",children:e.jsx(F,{element:s})}),e.jsx("td",{"data-cy":"menu-title",children:s.menuTitle}),e.jsx("td",{"data-cy":"menu-slug",children:s.menuSlug}),e.jsx("td",{"data-cy":"position",children:s.position}),e.jsx("td",{children:e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx(P,{to:`/register_meta?belongsTo=${l.OPTION_PAGE}&find=${s.menuSlug}`,children:t("Create")}),e.jsx(G,{find:s.menuSlug,belongsTo:l.OPTION_PAGE})]})}),e.jsx("td",{children:e.jsx(S,{name:"option-page-child-menu",buttonClass:x.SECONDARY,anchor:e.jsx(w,{icon:"bx:dots-vertical-rounded",color:I(),width:24}),links:[e.jsx("a",{href:"#",onClick:i=>{i.preventDefault(),c(s.id)},children:t("Duplicate")}),e.jsx(v,{page:u,id:s.id}),e.jsx(M,{belongsTo:l.OPTION_PAGE,find:s.menuSlug}),e.jsx(P,{to:`/permissions/page/${s.menuSlug}/${s.id}`,className:"color-warning",children:t("Permissions")})]})})]})})})]})});Y.propTypes={record:E.object.isRequired,page:E.number.isRequired};const we=()=>{const n=document.globals,u=n.settings;Z(l.OPTION_PAGE);const[b,o]=g.useReducer(a=>a+1,0);me();const c=g.useRef(),s=re({mode:"all"}),i=ce({control:s.control,name:"elements"}),y=$(),{data:p,loading:A}=ee(a=>a.fetchOptionPages),{page:m}=z(),h=u.length>0&&N(u,"key","records_per_page")!==""?N(u,"key","records_per_page").value:20,j=Math.ceil(p.count/h);g.useEffect(()=>{se(t("Option pages")),te("#/option-pages"),y(ne({page:m||1,perPage:h})).then(a=>{J()})},[m]),g.useEffect(()=>{(()=>{if(!i)return!1;let r=0;for(const[d,H]of Object.entries(i))H===!0&&r++;return r===Object.entries(i).length})()?c.current.checked=!0:c.current&&(c.current.checked=!1)},[i]),document.addEventListener("restoredElement",function(){o()});const U=a=>{s.reset(),a.belongsTo=l.OPTION_PAGE;const r=a.action;if(r)switch(r){case"hide":ie(a);break;case"delete":case"duplicate":q("bulkActionsAction",a).then(d=>{if(d.success===!0){switch(a.action){case"delete":k("Option pages successfully deleted.");break;case"duplicate":k("Option pages successfully duplicated.");break}s.resetField("elements"),L(),C()}else f.error(d.error)}).catch(d=>{console.error(d),f.error(t("Unknown error, please retry later"))});break}},V=a=>{p.records.filter(r=>!O(r.id,l.OPTION_PAGE)).map(r=>{s.setValue(`elements.${r.id}`,a),r.children&&r.children.filter(d=>!O(d.id,l.OPTION_PAGE)).map(d=>{s.setValue(`elements.${d.id}`,a)})})},W=[e.jsx(D,{style:x.PRIMARY,to:"/option-pages-manage",children:t("Manage pages")})];return A?e.jsx(ae,{}):e.jsx(de,{...s,children:e.jsx("form",{onSubmit:s.handleSubmit(U),children:e.jsxs(Q,{title:t("Option pages"),actions:W,crumbs:[{label:t("Option pages")}],children:[e.jsx(pe,{belongsTo:l.OPTION_PAGE}),p.records&&p.records.length>0?e.jsx("div",{className:"responsive with-shadow b-rounded",children:e.jsxs("table",{"data-cy":"pages-table",className:`acpt-table rounded ${n.is_rtl?"rtl":""}`,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"24px"},children:e.jsxs("label",{className:"checkbox",htmlFor:"all",children:[e.jsx("input",{ref:c,type:"checkbox",id:"all",defaultChecked:!1,onClick:a=>V(a.currentTarget.checked)}),e.jsx("span",{})]})}),e.jsx("th",{}),e.jsx("th",{children:e.jsx(T,{tip:t("Taxonomy slug. The post name/slug. Used for various queries for taxonomy content."),label:t("The page title")})}),e.jsx("th",{children:t("Type")}),e.jsx("th",{children:e.jsx(T,{tip:t("Taxonomy slug. The post name/slug. Used for various queries for taxonomy content."),label:t("Menu title")})}),e.jsx("th",{children:e.jsx(T,{tip:t("The page slug (used to generate the page URL). Must be unique"),label:t("Menu slug")})}),e.jsx("th",{children:e.jsx(T,{tip:t("This number controls the position of this page in the admin menu"),label:t("Menu position")})}),e.jsx("th",{children:t("Field groups")}),e.jsx("th",{children:t("Actions")})]})}),e.jsx("tbody",{children:p.records&&p.records.map(a=>{if(!O(a.id,l.OPTION_PAGE))return e.jsx(Y,{page:m,record:a},a.id)})}),j>1&&e.jsx("tfoot",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:9,children:e.jsx(oe,{currentPage:m?parseInt(m):1,totalPages:j,baseLink:"/taxonomies"})})})})]})}):e.jsx("div",{className:"p-24 bg-white with-shadow",children:e.jsxs("div",{className:"b-maxi b-rounded p-24 flex-column s-12 text-center",children:[e.jsx("span",{children:t("No option pages found.")}),e.jsx("div",{children:e.jsx(D,{type:"button",style:x.SECONDARY,to:"/option-pages-manage",children:t("Register the first one")})})]})})]})})})};export{we as default};
