import{u as r,j as t}from"./fields-Uuj9pZLj.js";import{a as i,R as C}from"./vendor-D21mNUGX.js";import{L as j,n as c}from"./Layout-CbPpDR-w.js";import{C as v}from"./index-Dp7DyYVn.js";import{C as u}from"./CardRow-D0wbqPA3.js";import{m as R,c as g,B as p,s as m,A,w as f}from"./index-DW87FRXD.js";const T=()=>{const[a,d]=i.useState(null),[o,l]=i.useState([]),x=()=>{f("runRepairAction",{}).then(e=>{e.success?(c.success(r("The repair was carried out successfully.")),n()):c.error(e.error)}).catch(e=>{console.error(e),c.error(r("Something went wrong, please retry."))})},n=()=>{d(null),l([]),f("healthCheckAction",{}).then(e=>{d(e),e.db!=="ok"&&l(s=>[...s,"db"]),e.version!=="ok"&&l(s=>[...s,"version"]),e.cache!=="ok"&&l(s=>[...s,"cache"])}).catch(e=>{console.error(e),c.error(r("Something went wrong, please retry."))})};i.useEffect(()=>{R(r("Health check")),g("#/tools"),n()},[]);let k=[t.jsx(p,{style:m.SECONDARY,onClick:e=>{e.preventDefault(),n()},children:r("Run health check")})];(o==null?void 0:o.length)>0&&k.push(t.jsx(p,{style:m.PRIMARY,onClick:e=>{e.preventDefault(),x()},children:r("Launch the repair")}));const h=e=>t.jsx("div",{className:`color-${e==="ok"?"success":"danger"}`,children:e});return t.jsx(j,{title:r("Health check"),actions:k,crumbs:[{label:r("ACPT Tools"),link:"/tools"},{label:r("Health check")}],children:a?t.jsx(C.Fragment,{children:t.jsxs(v,{title:r("Health check"),children:[t.jsx(u,{label:r("Plugin version"),value:h(a.version)}),t.jsx(u,{label:r("DB status"),value:h(a.db)}),t.jsx(u,{label:r("Cache"),value:h(a.cache)})]})}):t.jsx(A,{style:m.WARNING,children:"Health check running..."})})};export{T as default};
