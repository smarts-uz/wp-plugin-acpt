import{j as e,u as t}from"./fields-Uuj9pZLj.js";import{a as g,R as A,u as we,h as Fe}from"./vendor-D21mNUGX.js";import{u as R,c as M,b as w,g as te,a as Ee,F as ke}from"./index.esm-DCQn2FO4.js";import{u as S,B as D,s as y,c5 as Ae,c6 as le,P as j,c7 as Ie,I as E,J as V,w as qe,D as $,c8 as ae,A as Oe,a as k,c9 as ne,ca as ie,cb as re,cc as U,F as Y,y as Me,cd as Le,ce as Pe,M as Ve,cf as oe,bN as $e,bR as Ue,m as Be,c as _e,cg as We,ch as Ge,L as Ye,i as He,ci as Je}from"./index-DW87FRXD.js";import{n as P,b as B,u as se,B as ze,L as Xe}from"./Layout-CbPpDR-w.js";import{M as _}from"./index-mrXLwnSf.js";import{P as Ke}from"./index-DHZeBRHg.js";import{I as H}from"./InputHidden-Sd_YdD40.js";import{u as de}from"./index-DRV1MUeg.js";import{S as J}from"./index-DuvxZwho.js";import{u as W,C as G,a as ce}from"./sortable.esm-C-GypyhB.js";import{L}from"./Label-DH8FgXCw.js";import{S as ue}from"./Select-Cp1uHe-V.js";import{I as q}from"./Input-Dag95jow.js";import{T as O}from"./index-D3iHHJgH.js";import{M as me}from"./index-Bskps18W.js";import{B as Qe}from"./ButtonSwitch-B9KeMXNd.js";import"./index-Cwt3Qm9G.js";const Ze=()=>{const s=S(),{setValue:c}=R(),[u,r]=g.useState(!1),i=[e.jsx(D,{style:y.SUCCESS,onClick:o=>{o.preventDefault(),s(Ae()),s(le()),c("fields",[]),r(!u)},children:t("Yes")}),e.jsx(D,{style:y.DANGER,onClick:o=>{o.preventDefault(),r(!u)},children:t("No")})];return e.jsxs(A.Fragment,{children:[e.jsx(_,{title:t("Confirm deleting all"),visible:u,buttons:i,children:t("Are you sure?")}),e.jsx(D,{style:y.DANGER,onClick:o=>{o.preventDefault(),r(!u)},children:t("Delete all")})]})},es="Checkbox",ss="Color",ts="Date",ls="DateTime",as="Email",ns="Number",is="Phone",rs="PostObject",os="PostObjectMulti",he="Radio",pe="Select",xe="SelectMulti",ds="TermObject",cs="TermObjectMulti",z="Text",us="Textarea",ms="Time",hs="Url",ps="User",xs="UserMulti",fe=[{value:z,label:"Text"},{value:ss,label:"Color"},{value:ts,label:"Date"},{value:ls,label:"DateTime"},{value:as,label:"Email"},{value:ns,label:"Number"},{value:is,label:"Phone"},{value:ms,label:"Time"},{value:hs,label:"Url"},{value:us,label:"Textarea"},{value:pe,label:"Select"},{value:xe,label:"Select (Multiple)"},{value:es,label:"Checkbox"},{value:he,label:"Radio"},{value:rs,label:"Post object"},{value:os,label:"Post object (Multiple)"},{value:ds,label:"Term object"},{value:cs,label:"Term object (Multiple)"},{value:ps,label:"User"},{value:xs,label:"User (Multiple)"}],je=({fieldIndex:s,optionIndex:c})=>{const u=S(),r=()=>`fields.${s}.options`,{control:i}=R(),{remove:o}=M({control:i,name:r()}),[f,p]=g.useState(!1),a=[e.jsx(D,{style:y.SUCCESS,onClick:n=>{n.preventDefault(),u(Ie({fieldIndex:s,optionIndex:c})),o(c),p(!f)},children:t("Yes")}),e.jsx(D,{style:y.DANGER,onClick:n=>{n.preventDefault(),p(!f)},children:t("No")})];return e.jsxs("span",{children:[e.jsx(_,{title:t("Confirm deleting option"),visible:f,buttons:a,children:t("Are you sure?")}),e.jsx("a",{href:"#",onClick:n=>{n.preventDefault(),p(!f)},children:e.jsx(O,{icon:!1,tip:t("Delete"),label:e.jsx(E,{icon:"bx-trash",width:18,color:"#F94144"})})})]})};je.propTypes={fieldIndex:j.number.isRequired,optionIndex:j.number.isRequired};const be=g.memo(({index:s,fieldIndex:c,fieldId:u,option:r})=>{const i=b=>`fields.${c}.options.${s}.${b}`,{register:o,formState:{errors:f},control:p,setValue:a}=R(),n=w({control:p,name:i("value")}),h=w({control:p,name:i("label")}),{attributes:v,listeners:m,setNodeRef:l,transform:d}=W({id:r.id}),x={transform:G.Translate.toString(d)},[C,T]=g.useState(r.label===r.value),F=()=>n||(r.value?r.value:null),N=()=>h||(r.label?r.label:null);return e.jsxs("div",{className:"i-flex-center s-8",style:x,ref:l,children:[e.jsx(H,{id:i("id"),value:r.id,register:o}),e.jsx("span",{className:"cursor-move top-2 handle",...v,...m,children:e.jsx(E,{icon:"bx:dots-vertical-rounded",color:V(),width:18})}),e.jsxs("span",{className:"i-flex-center s-24 w-100",children:[e.jsx("span",{className:"w-100",children:e.jsx(q,{id:i("label"),register:o,errors:f,defaultValue:N(),onChangeCapture:b=>{C&&a(i("value"),b.target.value)},onClick:b=>{r.label&&b.target.value==="option"&&a(i("label"),null)},validate:{required:t("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}),e.jsx("span",{children:e.jsx("button",{type:"button",className:`acpt-btn-switch ${C?"active":""}`,onClick:b=>{b.preventDefault(),T(!C)},children:e.jsx(E,{icon:"bx:bx-link",width:"18px"})})}),e.jsx("span",{className:"w-100",children:e.jsx(q,{id:i("value"),register:o,errors:f,defaultValue:F(),onChangeCapture:b=>{C&&a(i("label"),b.target.value)},onClick:b=>{r.value&&b.target.value==="option"&&a(i("value"),null)},validate:{required:t("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}),e.jsx(je,{fieldIndex:c,optionIndex:s})]})]})});be.propTypes={fieldId:j.string.isRequired,index:j.number.isRequired,fieldIndex:j.number.isRequired,option:j.object.isRequired};const ve=({fieldId:s,fieldIndex:c})=>{const u=S(),[r,i]=g.useState(!1),[o,f]=g.useState(null),[p,a]=g.useState(null),[n,h]=g.useState(!1);g.useEffect(()=>{n&&(i(!0),qe("fetchDatasetsAction",{}).then(l=>{let d=[{value:null,label:t("Select"),items:[]}];l.records&&l.records.map(x=>{d.push({value:x.id,label:x.label?x.label:x.name,items:x.items?x.items:[]})}),f(d),i(!1)}).catch(l=>{console.error(l.message),i(!1)}))},[n]);const v=()=>{const l=o.filter(x=>x.value===p);if(l.length!==1)return;l[0].items.map(x=>{const C={id:$(),fieldId:s,label:x.label,value:x.value};u(ae({fieldIndex:c,option:C}))}),P.success(t("Dataset loaded correctly")),h(!n)},m=[e.jsx(D,{style:y.PRIMARY,disabled:p===null,onClick:l=>{l.preventDefault(),v()},children:t("Load dataset")}),e.jsx(D,{style:y.DANGER,onClick:l=>{l.preventDefault(),h(!n)},children:t("Close")})];return e.jsxs(A.Fragment,{children:[e.jsx(_,{title:t("Load dataset"),visible:n,padding:0,buttons:m,children:r?e.jsx("div",{className:"p-24",children:t("Loading...")}):e.jsx("div",{className:"p-24",children:e.jsx("select",{id:"dataset",className:"form-control default",onChangeCapture:l=>a(l.target.value),children:o&&o.map(l=>e.jsx("option",{value:l.value,children:l.label}))})})}),e.jsx("a",{href:"#",onClick:l=>{l.preventDefault(),h(!n)},children:t("Load dataset")})]})};ve.propTypes={fieldId:j.string.isRequired,fieldIndex:j.number.isRequired};const ge=({fieldId:s,fieldIndex:c,options:u})=>{const r=S(),i=()=>`fields.${c}.options`,{control:o}=R(),{move:f}=M({control:o,name:i()}),p=n=>{const{active:h,over:v}=n;if(h.id===v.id)return;const m=u.findIndex(d=>d.id===h.id),l=u.findIndex(d=>d.id===v.id);f(m,l)},a=()=>{const n={id:$(),fieldId:s,label:"option",value:"option"};r(ae({fieldIndex:c,option:n}))};return e.jsx("div",{children:e.jsxs("fieldset",{className:"acpt-fieldset",children:[e.jsx("legend",{children:t("Option list")}),u&&u.length>0?e.jsx(J,{onDragEnd:p,items:u,children:e.jsx("div",{className:"flex-column s-24",children:u&&u.map((n,h)=>e.jsx(be,{index:h,fieldIndex:c,fieldId:s,option:n}))})}):e.jsx(Oe,{style:y.WARNING,children:t('No options already created. Create the first one now by clicking the button "Add option"!')}),e.jsxs("div",{className:"i-flex-center s-8 mt-24",children:[e.jsx("a",{href:"#",onClick:n=>{n.preventDefault(),a()},children:t("Add option")}),e.jsx(ve,{fieldId:s,fieldIndex:c})]})]})})};ge.propTypes={fieldId:j.string.isRequired,fieldIndex:j.number.isRequired,options:j.array.isRequired};const X=({element:s})=>{const c=S(),{selectedElements:u}=k(i=>i.productDataFieldsState),r=()=>u.filter(o=>o.id===s.id).length>0;return e.jsx(O,{label:e.jsxs("label",{className:"checkbox",htmlFor:`select-${s.id}`,style:{top:"3px"},children:[e.jsx("input",{id:`select-${s.id}`,type:"checkbox",checked:r(),onChange:i=>{c(ne({element:s,selected:i.target.checked}))}}),e.jsx("span",{})]}),icon:!1,tip:t(r()?"Deselect this element":"Select this element")})};X.propTypes={element:j.object.isRequired};const Ne=({field:s,index:c})=>{const u=S(),{control:r}=R(),{remove:i}=M({control:r,name:"fields"}),[o,f]=g.useState(!1),p=[e.jsx(D,{style:y.SUCCESS,onClick:a=>{a.preventDefault(),u(ie({field:s})),i(c),f(!o)},children:t("Yes")}),e.jsx(D,{style:y.DANGER,onClick:a=>{a.preventDefault(),f(!o)},children:t("No")})];return e.jsxs(A.Fragment,{children:[e.jsx(_,{title:t("Confirm deleting option"),visible:o,buttons:p,children:t("Are you sure?")}),e.jsx("a",{href:"#",onClick:a=>{a.preventDefault(),f(!o)},children:e.jsx(E,{icon:"bx-trash",width:18,color:"#F94144"})})]})};Ne.propTypes={index:j.number.isRequired,field:j.object.isRequired};const K=({field:s,index:c})=>{const u=S(),{closedElements:r}=k(a=>a.productDataFieldsState),{control:i}=R(),{append:o}=M({control:i,name:"fields"}),f=()=>r.filter(n=>n===s.id).length===1,p=()=>{Me(s.id),f()?u(Le({id:s.id})):u(Pe({id:s.id}))};return e.jsxs("span",{className:"i-flex-center s-8",children:[e.jsx(O,{label:e.jsx("a",{href:"#",onClick:a=>{a.preventDefault();const n=re(s);u(U({field:n})),o(n),Y(1).then(()=>{B(n.id)})},children:e.jsx(E,{icon:"bx:duplicate",width:18})}),tip:t("Duplicate this meta field"),icon:!1}),e.jsx(O,{label:e.jsx(Ne,{index:c,field:s}),tip:t("Delete this meta field"),icon:!1}),e.jsx(O,{label:e.jsx("a",{href:"#",onClick:a=>{a.preventDefault(),p()},children:e.jsx(E,{icon:"bx:expand-alt",width:18})}),tip:t("Hide/show this meta field"),icon:!1})]})};K.propTypes={index:j.number.isRequired,field:j.object.isRequired};const ye=({field:s,index:c})=>{const{attributes:u,listeners:r,setNodeRef:i,isDragging:o,transform:f}=W({id:s.id}),p={transform:G.Translate.toString(f)};S(),k(N=>N.productDataFieldsState);const{register:a,formState:{errors:n},control:h,setValue:v}=R(),m=N=>`fields.${c}.${N}`,l=w({control:h,name:m("name")}),d=w({control:h,name:m("type")}),x=w({control:h,name:m("isRequired")}),C=()=>{const N=m("name"),b=te(n,N);return b?e.jsx("span",{className:"invalid-feedback",children:t(b.message)}):l||s.name},T=()=>d||s.type,F=N=>N===pe||N===xe||N===he;return e.jsx("tr",{id:s.id,ref:i,style:p,className:`bg-white ${o?"b-rounded z-100 with-drop-shadow":""}`,children:e.jsxs("td",{style:{background:Ve()},className:"with-active-border",colSpan:4,children:[e.jsx(H,{id:m("id"),value:s.id,register:a}),e.jsx("div",{className:"mb-24",children:e.jsxs("div",{className:"flex-between s-8 for-xs",children:[e.jsxs("span",{className:"i-flex-center s-8",children:[e.jsx("span",{className:"cursor-move top-2 handle",...u,...r,children:e.jsx(E,{icon:"bx:dots-vertical-rounded",color:V(),width:18})}),e.jsx(X,{element:{id:s.id}}),e.jsx("h3",{children:C()}),e.jsx("span",{className:"color-gray",children:e.jsx(me,{fieldType:T(),css:"top-2"})}),e.jsx("span",{className:"i-flex-center s-8",children:e.jsx(O,{label:e.jsx(A.Fragment,{children:e.jsx(Qe,{control:h,defaultValue:typeof x=="boolean"?x:s.isRequired,errors:n,icon:"foundation:asterisk",id:m("isRequired")})}),tip:t("Field required"),icon:!1})})]}),e.jsx(K,{field:s,index:c})]})}),e.jsx("div",{className:"bg-white with-border b-rounded p-24",children:e.jsxs("div",{className:"flex-column s-24",children:[e.jsxs("div",{className:"container align-end",children:[e.jsxs("div",{className:"col-6",children:[e.jsx(L,{isRequired:!0,id:m("name"),label:t("Name")}),e.jsx(q,{id:m("name"),register:a,errors:n,placeholder:t("Name"),defaultValue:s.name,onClick:N=>{s.name&&N.target.value==="field"&&v(m("name"),null)},validate:{required:t("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})]}),e.jsxs("div",{className:"col-6",children:[e.jsx(L,{isRequired:!0,id:m("type"),label:t("Field type")}),e.jsx(ue,{register:a,errors:n,id:m("type"),values:fe})]})]}),e.jsxs("div",{className:"container align-end",children:[e.jsxs("div",{className:"col-6",children:[e.jsx(L,{isRequired:!1,id:m("defaultValue"),label:t("Default value")}),e.jsx(q,{id:m("defaultValue"),register:a,errors:n,placeholder:t("Default value"),defaultValue:s.defaultValue,validate:{maxLength:{value:255,message:"max length is 255"}}})]}),e.jsxs("div",{className:"col-6",children:[e.jsx(L,{isRequired:!1,id:m("description"),label:t("A brief description")}),e.jsx(q,{id:m("description"),register:a,errors:n,placeholder:t("A brief description"),defaultValue:s.description,validate:{maxLength:{value:255,message:"max length is 255"}}})]})]}),F(T())&&e.jsx(ge,{fieldId:s.id,fieldIndex:c,options:s.options?s.options:[]})]})})]})})};ye.propTypes={index:j.number.isRequired,field:j.object.isRequired};const Ce=({field:s,index:c})=>{const{attributes:u,listeners:r,setNodeRef:i,isDragging:o,transform:f}=W({id:s.id}),p={transform:G.Translate.toString(f)};S(),k(I=>I.productDataFieldsState);const{register:a,formState:{errors:n},control:h,setValue:v}=R(),m=I=>`fields.${c}.${I}`,l=w({control:h,name:m("name")}),d=w({control:h,name:m("type")});w({control:h,name:m("isRequired")});const x=()=>{const I=m("name"),ee=te(n,I);return ee?e.jsx("span",{className:"invalid-feedback",children:t(ee.message)}):l||s.name},C=()=>d||s.type,[T,F]=g.useState(!1),[N,b]=g.useState(!1),Q=g.useRef(),Z=g.useRef();return se([Q],()=>{b(!1)}),se([Z],()=>{F(!1)}),e.jsx(A.Fragment,{children:e.jsxs("tr",{id:s.id,ref:i,style:p,className:`bg-white b-rounded ${o?"z-100 with-drop-shadow":""}`,children:[e.jsx("td",{children:e.jsxs("span",{className:"i-flex-center s-8",children:[e.jsx("span",{className:"cursor-move handle top-2",...u,...r,children:e.jsx(E,{icon:"bx:dots-vertical-rounded",color:V(),width:18})}),e.jsx(X,{element:{id:s.id}})]})}),e.jsx("td",{children:T?e.jsx("div",{ref:Z,style:{maxWidth:"200px"},children:e.jsx(q,{id:m("name"),register:a,errors:n,placeholder:t("Name"),defaultValue:s.name,onClick:I=>{s.name&&I.target.value==="field"&&v(m("name"),null)},validate:{required:t("This field is mandatory"),maxLength:{value:255,message:"max length is 255"}}})}):e.jsx("div",{className:"i-flex-center s-8 cursor-pointer",onClick:()=>{window.innerWidth>=960&&F(!T)},children:x()})}),e.jsx("td",{children:N?e.jsx("div",{ref:Q,style:{maxWidth:"200px"},children:e.jsx(ue,{register:a,id:m("type"),errors:n,defaultValue:s.type,values:fe})}):e.jsx("div",{className:"i-flex-center s-8 cursor-pointer",onClick:()=>{window.innerWidth>=960&&b(!N)},children:e.jsx(me,{fieldType:C(),css:"with-border b-rounded p-8"})})}),e.jsx("td",{children:e.jsx(K,{field:s,index:c})})]})})};Ce.propTypes={index:j.number.isRequired,field:j.object.isRequired};const De=({field:s,index:c})=>{const{closedElements:u}=k(i=>i.productDataFieldsState);return u.filter(o=>o===s.id).length===1?e.jsx(Ce,{field:s,index:c}):e.jsx(ye,{field:s,index:c})};De.propTypes={index:j.number.isRequired,field:j.object.isRequired};const fs=()=>{const s=S(),{selectedElements:c}=k(h=>h.productDataFieldsState),{control:u,setValue:r,getValues:i}=R(),o=w({control:u,name:"fields"}),f=g.useRef(null),[p,a]=g.useState(null),n=()=>{c.map(h=>{const v=o.findIndex(l=>l.id===h.id),m=o[v];switch(p){case"duplicate":const l=re(m);o.push(l),r("fields",o),s(U({field:l}));break;case"delete":const d={...m},x=i("fields").filter(C=>C.id!==h.id);r("fields",x),s(ie({field:d}));break}}),(p==="delete"||p==="duplicate")&&s(le()),f.current.value=""};return e.jsx(A.Fragment,{children:c.length>0&&e.jsxs("div",{className:"flex-between mb-24",children:[e.jsxs("div",{children:[c.length," ",t("Selected items")]}),e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsxs("select",{ref:f,className:"form-control sm",onChange:h=>{a(h.target.value!==""?h.target.value:null)},children:[e.jsx("option",{value:"",children:t("Select")}),e.jsx("option",{value:"duplicate",children:t("Duplicate")}),e.jsx("option",{value:"delete",children:t("Delete")})]}),e.jsx(D,{style:y.WHITE,size:"sm",disabled:p===null,onClick:h=>{h.preventDefault(),n()},children:t("Execute")})]})]})})},Se=({field:s,index:c})=>{const{control:u}=R(),r=w({control:u,name:`fields.${c}.name`}),{attributes:i,listeners:o,setNodeRef:f,transform:p}=W({id:s.id}),a={transform:G.Translate.toString(p)};return e.jsxs("div",{className:"tree-el flex-between s-8",ref:f,style:a,children:[e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx("span",{className:"cursor-move top-2 handle",...i,...o,children:e.jsx(E,{icon:"bx:dots-vertical-rounded",color:V(),width:18})}),e.jsx("span",{className:"text-ellipsis cursor-pointer",onClick:n=>{n.preventDefault(),B(`${s.id}`)},children:r||s.name})]}),e.jsx(ze,{style:y.SECONDARY,children:"F"})]},s.id)};Se.propTypes={field:j.object.isRequired,index:j.number.isRequired};const Re=({fields:s})=>{const u=document.globals.globals;if(s.length===0)return null;const r=S(),{control:i}=R(),{move:o}=M({control:i,name:"fields"}),f=p=>{const{active:a,over:n}=p;if(a.id===n.id)return;const h=s.findIndex(l=>l.id===a.id),v=s.findIndex(l=>l.id===n.id),m=ce(s,h,v);o(h,v),r(oe(m))};return e.jsxs("div",{className:"b-rounded with-shadow bg-white p-24",children:[e.jsx("h3",{className:"mb-24 flex-between s-8",children:e.jsx("span",{className:"text-ellipsis cursor-pointer",children:t("product data fields")})}),e.jsx("div",{className:`tree ${u.is_rtl===!0?"rtl":""}`,children:e.jsx(J,{onDragEnd:f,items:s,children:e.jsx(A.Fragment,{children:s.length>0&&s.map((p,a)=>e.jsx(Se,{index:a,field:p}))})})})]})};Re.propTypes={fields:j.array.isRequired};const Te=({fields:s})=>{const c=document.globals;c.settings;const u=c.globals,[r]=de(),i=S(),{control:o}=R(),{move:f}=M({control:o,name:"fields"}),p="wp_product_data",[a,n]=g.useState($e(p)),h=d=>{const{active:x,over:C}=d;if(x.id===C.id)return;const T=s.findIndex(b=>b.id===x.id),F=s.findIndex(b=>b.id===C.id),N=ce(s,T,F);f(T,F),i(oe(N))},v=d=>{s&&s.map(x=>{i(ne({element:x,selected:d}))})},m=()=>{const d=$();i(U({field:{id:d,name:"field",type:z,isRequired:!1,description:null,defaultValue:null,options:[]}})),Y(1).then(()=>{B(d)})},l=d=>{Ue(p,d),n(!a)};return e.jsxs(A.Fragment,{children:[e.jsxs("div",{className:`flex-between s-8 ${s.length===0?" mb-12":""}`,children:[e.jsxs("div",{className:"i-flex-center s-8",children:[e.jsx("h3",{children:t("product data fields")}),e.jsx("span",{className:"px-8 py-4 font-sm bg-light-gray text-normal b-rounded",children:s.length>0?s.length:0})]}),s.length>0&&e.jsxs("div",{className:"i-flex-center s-8 mb-24",children:[e.jsx("div",{className:"toggle-group",children:e.jsxs("label",{htmlFor:"toggle_navigation",className:"toggle",children:[e.jsx("input",{id:"toggle_navigation",type:"checkbox",checked:a,onChangeCapture:d=>{l(d.target.checked)}}),e.jsx("span",{className:"slider round"})]})}),e.jsx("label",{className:"cursor-pointer",htmlFor:"toggle_navigation",children:t(a?"Hide navigation":"Show navigation")})]})]}),e.jsx(fs,{}),s&&s.length>0?e.jsxs("div",{className:"container",children:[a&&e.jsx("div",{className:"col-3 flex-column s-24 hidden-xs sticky",style:{top:"130px"},children:e.jsx(Re,{fields:s})}),e.jsx("div",{className:`flex-column s-24 ${a?"col-9":"col-12"}`,children:e.jsxs("div",{className:"responsive with-shadow b-rounded",children:[e.jsxs("table",{className:`acpt-table  ${u.is_rtl?"rtl":""}`,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"10px"},children:e.jsxs("label",{className:"checkbox",htmlFor:"select-fields",style:{marginLeft:"26px"},children:[e.jsx("input",{id:"select-fields",type:"checkbox",onChange:d=>{v(d.target.checked)}}),e.jsx("span",{})]})}),e.jsx("th",{children:t("Name")}),e.jsx("th",{children:t("Type")}),e.jsx("th",{children:t("Actions")})]})}),e.jsx("tbody",{ref:r,children:e.jsx(J,{onDragEnd:h,items:s,children:s&&s.map((d,x)=>e.jsx(De,{field:d,index:x}))})})]}),e.jsx("div",{className:"p-24 bg-white",children:e.jsx(D,{type:"button",style:y.SECONDARY,onClick:d=>{d.preventDefault(),m()},children:t("Add field")})})]})})]}):e.jsx("div",{className:"mb-24 p-24 bg-white with-shadow",children:e.jsxs("div",{className:"b-maxi b-rounded p-24 flex-column s-12 text-center",children:[e.jsx("span",{children:t('No fields already created. Create the first one now by clicking the button "Add field"!')}),e.jsx("div",{children:e.jsx(D,{type:"button",style:y.SECONDARY,onClick:d=>{d.preventDefault(),m()},children:t("Add field")})})]})})]})};Te.propTypes={fields:j.array.isRequired};const Os=({})=>{const s=S(),{loading:c}=k(l=>l.fetchProductDataFields),{fields:u}=k(l=>l.productDataFieldsState),{id:r}=we(),[i,o]=g.useState(!1),f=Fe(),[p]=de(),a=Ee({mode:"all"});g.useEffect(()=>{Be(t("Manage product data fields")),_e("#/"),s(We(r)).then(l=>{s(Ge(l.payload)),l.payload&&l.payload.map((d,x)=>{a.setValue(`fields.${x}`,d)})}).catch(l=>{console.error(l),o(!0)})},[]);const n=()=>{const l=$();s(U({field:{id:l,name:"field",type:z,isRequired:!1,description:null,defaultValue:null,options:[]}})),Y(1).then(()=>{B(l)})},h=()=>!(a.formState.errors&&a.formState.errors.pages),v=l=>{s(Je(l)).then(d=>{const x=d.payload;x.success?(f(`/product-data/product/fields/${r}`),P.success(t("WooCommerce product data fields successfully saved"))):P.error(x.error)}).catch(d=>{P.error(d)})},m=[e.jsx(D,{style:y.SECONDARY,onClick:l=>{l.preventDefault(),n()},children:t("Add field")}),e.jsx(D,{disabled:!h(),style:y.PRIMARY,children:t("Save")}),e.jsx(Ze,{})];return c?e.jsx(Ye,{}):i?e.jsx(Ke,{}):e.jsx(ke,{...a,children:e.jsx("form",{onSubmit:a.handleSubmit(v),children:e.jsxs(Xe,{title:t("Manage option pages"),actions:m,crumbs:[{label:t("Registered Custom Post Types"),link:"/"},{label:t("WooCommerce product data"),link:"/product-data/product"},{label:t("product data fields")}],children:[e.jsx(H,{register:a.register,id:"productDataId",value:r}),e.jsx("div",{ref:p,children:e.jsx(Te,{fields:He(u)?[]:u})})]})})})};export{Os as default};
